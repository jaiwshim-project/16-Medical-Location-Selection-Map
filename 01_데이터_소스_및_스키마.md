# 01. 데이터 소스·비용·계약 방식 & 개발자용 스키마

---

## 1️⃣ 데이터별 비용·계약 방식

### A. 공공 데이터 (무료/저비용)

| # | 데이터명 | 제공기관 | 비용 | 취득 방식 | 갱신 주기 |
|---|---------|---------|------|----------|----------|
| 1 | 건강보험 요양기관 현황 | 국민건강보험공단 | 무료 | 공공데이터포털 API | 월 1회 |
| 2 | 건강보험 청구 통계 (치과) | 건강보험심사평가원 (HIRA) | 무료 | 공공데이터포털 API | 분기 |
| 3 | 행정동별 인구·세대 통계 | 행정안전부 | 무료 | 주민등록 인구통계 API | 월 1회 |
| 4 | 연령·성별 인구 구조 | 통계청 (KOSIS) | 무료 | KOSIS API | 월/연 |
| 5 | 사업체 조사 (상권) | 통계청 | 무료 | KOSIS/SGIS API | 연 1회 |
| 6 | 소상공인 상권정보 | 소상공인시장진흥공단 | 무료 | 상권정보시스템 API | 분기 |
| 7 | 건축물대장 (면적·용도) | 국토교통부 | 무료 | 공공데이터포털 API | 수시 |
| 8 | 개별공시지가 | 국토교통부 | 무료 | 공공데이터포털 API | 연 1회 |
| 9 | 상가 임대 시세 | 한국부동산원 | 무료 | 부동산 정보 API | 분기 |
| 10 | 유동인구 데이터 | 서울열린데이터광장 등 | 무료 | 지자체 API | 월/분기 |
| 11 | 교통량 데이터 | 국가교통DB (KTDB) | 무료 | API/파일 | 연 1회 |
| 12 | 대중교통 노선·역 위치 | 국토교통부/각 지자체 | 무료 | TAGO API | 수시 |

### B. 유료 데이터 (상업용)

| # | 데이터명 | 제공업체 | 예상 비용 | 계약 방식 | 비고 |
|---|---------|---------|----------|----------|------|
| 1 | 카드 매출 데이터 (업종별) | 나이스정보통신, BC카드 | 월 50~300만원 | API 구독 | 상권 매출 추정 핵심 |
| 2 | 통신사 유동인구 | SKT 지오비전, KT 빅데이터 | 월 100~500만원 | API 구독 | 시간대별·연령별 유동인구 |
| 3 | 부동산 실거래·임대 | 직방, 다방 API 또는 크롤링 | 월 30~100만원 | API/협약 | 상가 임대료 실시간 |
| 4 | 네이버 플레이스 리뷰·평점 | 자체 크롤링 또는 서드파티 | 서버비 수준 | 크롤링 | 법적 리스크 검토 필요 |
| 5 | 의료기관 폐업·개업 이력 | 건강보험공단 정보공개 | 무료~소액 | 정보공개청구 | 인수 매물 판단 |
| 6 | 신용평가·대출 금리 | 각 은행/핀테크 API | 건당 과금 | API 연동 | 투자금 시뮬레이션용 |

### C. 자체 생성 데이터

| # | 데이터명 | 생성 방식 | 용도 |
|---|---------|----------|------|
| 1 | 사용자 입력 프로필 | 회원가입 시 설문 | 원장 유형 분류 |
| 2 | 매물 DB | 부동산 중개사 네트워크 | 실시간 매물 정보 |
| 3 | 개업 성공/실패 사례 | 제휴 원장 인터뷰·설문 | AI 학습·벤치마크 |
| 4 | 장비·인테리어 견적 | 업체 제휴 | 투자금 산출 |

---

## 2️⃣ MVP 기준 최소 데이터 세트

> MVP에서는 **무료 공공 데이터 + 최소 1개 유료 데이터**로 시작

### 필수 (Must Have) — MVP Day 1

| 우선순위 | 데이터 | 소스 | 비용 | 용도 |
|---------|--------|------|------|------|
| ★★★ | 치과 요양기관 목록·위치 | 건강보험공단 | 무료 | 경쟁 치과 분포 |
| ★★★ | 행정동별 인구·연령 | 행정안전부/통계청 | 무료 | 수요 추정 |
| ★★★ | 상권정보 (업종·매출 등급) | 소상공인진흥공단 | 무료 | 상권 등급 판정 |
| ★★★ | 건축물대장 (용도·면적) | 국토교통부 | 무료 | 개원 가능 건물 필터 |
| ★★★ | 공시지가·임대 시세 | 국토부/부동산원 | 무료 | 임대료 추정 |
| ★★☆ | 대중교통 접근성 | TAGO API | 무료 | 입지 점수 |

### 권장 (Should Have) — MVP + 1~2개월

| 우선순위 | 데이터 | 소스 | 비용 | 용도 |
|---------|--------|------|------|------|
| ★★☆ | 카드 매출 데이터 | 나이스/BC카드 | 월 50만원~ | 상권 매출 검증 |
| ★★☆ | 통신사 유동인구 | SKT/KT | 월 100만원~ | 유동인구 정밀 분석 |
| ★☆☆ | 네이버 플레이스 리뷰 | 크롤링 | 서버비 | 경쟁 치과 평판 |

### MVP 월간 데이터 비용 추정

```
공공 데이터 API 서버비:    약 30만원/월
유료 데이터 (카드매출 1종): 약 50~100만원/월
지도 API (카카오/네이버):  약 10~30만원/월
──────────────────────────
MVP 합계:               약 90~160만원/월
```

---

## 3️⃣ 개발자용 데이터 스키마

### 마스터 테이블 구조 (PostgreSQL + PostGIS)

```sql
-- ============================================================
-- 1. 지역 마스터 (행정구역)
-- ============================================================
CREATE TABLE regions (
    region_id         SERIAL PRIMARY KEY,
    sido_code         CHAR(2) NOT NULL,          -- 시도 코드
    sigungu_code      CHAR(5) NOT NULL,          -- 시군구 코드
    dong_code         CHAR(10) NOT NULL UNIQUE,  -- 행정동 코드
    sido_name         VARCHAR(20) NOT NULL,
    sigungu_name      VARCHAR(20) NOT NULL,
    dong_name         VARCHAR(30) NOT NULL,
    center_point      GEOMETRY(POINT, 4326),     -- 중심 좌표
    boundary          GEOMETRY(MULTIPOLYGON, 4326), -- 행정동 경계
    created_at        TIMESTAMPTZ DEFAULT NOW(),
    updated_at        TIMESTAMPTZ DEFAULT NOW()
);

CREATE INDEX idx_regions_geom ON regions USING GIST(boundary);
CREATE INDEX idx_regions_dong ON regions(dong_code);

-- ============================================================
-- 2. 인구 통계
-- ============================================================
CREATE TABLE demographics (
    demo_id           SERIAL PRIMARY KEY,
    dong_code         CHAR(10) REFERENCES regions(dong_code),
    base_year_month   CHAR(6) NOT NULL,          -- YYYYMM
    total_population  INTEGER,
    male_population   INTEGER,
    female_population INTEGER,
    household_count   INTEGER,
    age_0_9           INTEGER,
    age_10_19         INTEGER,
    age_20_29         INTEGER,
    age_30_39         INTEGER,
    age_40_49         INTEGER,
    age_50_59         INTEGER,
    age_60_69         INTEGER,
    age_70_plus       INTEGER,
    avg_age           DECIMAL(4,1),
    population_density DECIMAL(10,2),            -- 명/km²
    created_at        TIMESTAMPTZ DEFAULT NOW(),
    UNIQUE(dong_code, base_year_month)
);

-- ============================================================
-- 3. 치과 의원 (경쟁 현황)
-- ============================================================
CREATE TABLE dental_clinics (
    clinic_id         SERIAL PRIMARY KEY,
    hira_code         VARCHAR(20) UNIQUE,        -- 심평원 요양기관 코드
    clinic_name       VARCHAR(100) NOT NULL,
    clinic_type       VARCHAR(20),               -- 일반치과, 교정, 임플란트 등
    address_road      VARCHAR(200),              -- 도로명 주소
    address_jibun     VARCHAR(200),              -- 지번 주소
    dong_code         CHAR(10) REFERENCES regions(dong_code),
    location          GEOMETRY(POINT, 4326),     -- 좌표
    dentist_count     INTEGER,                   -- 치과의사 수
    open_date         DATE,                      -- 개설일
    close_date        DATE,                      -- 폐업일 (NULL=영업중)
    is_active         BOOLEAN DEFAULT TRUE,
    specialties       TEXT[],                     -- 전문 분야 배열
    naver_place_id    VARCHAR(50),               -- 네이버 플레이스 ID
    naver_rating      DECIMAL(2,1),
    naver_review_cnt  INTEGER,
    created_at        TIMESTAMPTZ DEFAULT NOW(),
    updated_at        TIMESTAMPTZ DEFAULT NOW()
);

CREATE INDEX idx_clinics_geom ON dental_clinics USING GIST(location);
CREATE INDEX idx_clinics_dong ON dental_clinics(dong_code);
CREATE INDEX idx_clinics_active ON dental_clinics(is_active);

-- ============================================================
-- 4. 상권 정보
-- ============================================================
CREATE TABLE commercial_districts (
    district_id       SERIAL PRIMARY KEY,
    district_code     VARCHAR(20) UNIQUE,        -- 상권 코드
    district_name     VARCHAR(100),
    district_type     VARCHAR(20),               -- 골목, 발달, 전통시장, 관광특구
    dong_code         CHAR(10) REFERENCES regions(dong_code),
    boundary          GEOMETRY(MULTIPOLYGON, 4326),
    total_store_count INTEGER,                   -- 총 점포 수
    medical_store_cnt INTEGER,                   -- 의료업종 수
    dental_store_cnt  INTEGER,                   -- 치과 수
    food_store_cnt    INTEGER,                   -- 요식업 수
    monthly_sales_avg BIGINT,                    -- 월평균 매출 (원)
    floating_pop_day  INTEGER,                   -- 일 유동인구
    commercial_grade  CHAR(1),                   -- A/B/C/D/E 등급
    base_quarter      CHAR(6),                   -- YYYYQQ
    created_at        TIMESTAMPTZ DEFAULT NOW()
);

CREATE INDEX idx_comm_geom ON commercial_districts USING GIST(boundary);

-- ============================================================
-- 5. 부동산·임대 정보
-- ============================================================
CREATE TABLE real_estate (
    property_id       SERIAL PRIMARY KEY,
    property_type     VARCHAR(20),               -- 상가, 오피스, 복합
    address_road      VARCHAR(200),
    dong_code         CHAR(10) REFERENCES regions(dong_code),
    location          GEOMETRY(POINT, 4326),
    floor             VARCHAR(10),               -- 층
    area_m2           DECIMAL(10,2),             -- 전용면적 (m²)
    area_pyeong       DECIMAL(8,2),              -- 평수
    deposit_krw       BIGINT,                    -- 보증금 (원)
    monthly_rent_krw  BIGINT,                    -- 월세 (원)
    maintenance_krw   INTEGER,                   -- 관리비 (원)
    is_available      BOOLEAN DEFAULT TRUE,
    building_year     INTEGER,                   -- 건축년도
    parking_count     INTEGER,                   -- 주차 대수
    elevator          BOOLEAN,
    source            VARCHAR(50),               -- 직방, 다방, 부동산114 등
    source_url        TEXT,
    listed_at         DATE,
    created_at        TIMESTAMPTZ DEFAULT NOW(),
    updated_at        TIMESTAMPTZ DEFAULT NOW()
);

CREATE INDEX idx_realestate_geom ON real_estate USING GIST(location);

-- ============================================================
-- 6. 교통·접근성
-- ============================================================
CREATE TABLE transportation (
    transport_id      SERIAL PRIMARY KEY,
    station_name      VARCHAR(50),
    transport_type    VARCHAR(20),               -- 지하철, 버스정류장
    line_name         VARCHAR(30),               -- 호선/노선명
    location          GEOMETRY(POINT, 4326),
    dong_code         CHAR(10) REFERENCES regions(dong_code),
    daily_passengers  INTEGER,                   -- 일 이용객 수
    created_at        TIMESTAMPTZ DEFAULT NOW()
);

CREATE INDEX idx_transport_geom ON transportation USING GIST(location);

-- ============================================================
-- 7. 투자 비용 기준 테이블
-- ============================================================
CREATE TABLE investment_standards (
    standard_id       SERIAL PRIMARY KEY,
    category          VARCHAR(30) NOT NULL,      -- 인테리어, 장비, 인건비 등
    item_name         VARCHAR(100) NOT NULL,
    unit              VARCHAR(20),               -- 평당, 대당, 월 등
    min_cost_krw      BIGINT,
    avg_cost_krw      BIGINT,
    max_cost_krw      BIGINT,
    is_required       BOOLEAN DEFAULT TRUE,      -- 필수 여부
    clinic_scale      VARCHAR(10),               -- S/M/L
    note              TEXT,
    updated_at        TIMESTAMPTZ DEFAULT NOW()
);

-- ============================================================
-- 8. 사용자 (원장) 프로필
-- ============================================================
CREATE TABLE users (
    user_id           UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    email             VARCHAR(255) UNIQUE NOT NULL,
    password_hash     VARCHAR(255) NOT NULL,
    name              VARCHAR(50),
    phone             VARCHAR(20),
    dentist_type      VARCHAR(30),               -- 신규, 경력, 전문의 등
    experience_years  INTEGER,
    specialties       TEXT[],                     -- 전문 분야
    budget_min_krw    BIGINT,                    -- 예산 하한
    budget_max_krw    BIGINT,                    -- 예산 상한
    preferred_regions TEXT[],                     -- 선호 지역
    opening_type      VARCHAR(20),               -- 신규개원, 인수, 미정
    target_scale      VARCHAR(10),               -- S/M/L
    subscription_plan VARCHAR(20) DEFAULT 'free', -- free/basic/premium
    created_at        TIMESTAMPTZ DEFAULT NOW(),
    updated_at        TIMESTAMPTZ DEFAULT NOW()
);

-- ============================================================
-- 9. 분석 리포트
-- ============================================================
CREATE TABLE analysis_reports (
    report_id         UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    user_id           UUID REFERENCES users(user_id),
    report_type       VARCHAR(30),               -- location, investment, comparison
    target_dong_code  CHAR(10),
    target_location   GEOMETRY(POINT, 4326),

    -- 점수 (100점 만점)
    score_total       DECIMAL(5,2),
    score_population  DECIMAL(5,2),              -- 인구 점수
    score_competition DECIMAL(5,2),              -- 경쟁 점수 (낮을수록 좋음)
    score_access      DECIMAL(5,2),              -- 접근성 점수
    score_cost        DECIMAL(5,2),              -- 비용 효율 점수
    score_growth      DECIMAL(5,2),              -- 성장성 점수

    -- 투자 산출
    total_investment  BIGINT,                    -- 총 투자금
    monthly_fixed     BIGINT,                    -- 월 고정비
    monthly_revenue   BIGINT,                    -- 예상 월 매출
    breakeven_months  INTEGER,                   -- 손익분기 개월

    -- AI 생성 텍스트
    summary_text      TEXT,                      -- 종합 요약
    recommendation    TEXT,                      -- 추천 문장
    risk_factors      JSONB,                     -- 리스크 요인

    -- 판단
    decision_type     VARCHAR(20),               -- open_new, acquire, skip
    confidence_level  DECIMAL(3,2),              -- 0.00~1.00

    created_at        TIMESTAMPTZ DEFAULT NOW()
);

CREATE INDEX idx_reports_user ON analysis_reports(user_id);

-- ============================================================
-- 10. 인수 매물 (개업 vs 인수 비교용)
-- ============================================================
CREATE TABLE acquisition_listings (
    listing_id        SERIAL PRIMARY KEY,
    clinic_id         INTEGER REFERENCES dental_clinics(clinic_id),
    asking_price_krw  BIGINT,                    -- 양도가
    monthly_revenue   BIGINT,                    -- 월 매출 (자기 신고)
    patient_count     INTEGER,                   -- 일 평균 환자 수
    equipment_list    JSONB,                     -- 장비 목록
    lease_remaining   INTEGER,                   -- 잔여 임대 기간 (월)
    reason_for_sale   TEXT,                      -- 매각 사유
    is_verified       BOOLEAN DEFAULT FALSE,
    listed_at         DATE,
    source            VARCHAR(50),
    created_at        TIMESTAMPTZ DEFAULT NOW()
);
```

### ERD 관계 요약

```
regions ──< demographics        (1:N, 월별)
regions ──< dental_clinics      (1:N)
regions ──< commercial_districts(1:N)
regions ──< real_estate         (1:N)
regions ──< transportation      (1:N)

users ──< analysis_reports      (1:N)
dental_clinics ──< acquisition_listings (1:1)
```

### API 엔드포인트 스키마 (REST)

```
GET    /api/v1/regions?sido=서울&sigungu=강남구
GET    /api/v1/regions/{dong_code}/demographics
GET    /api/v1/regions/{dong_code}/clinics
GET    /api/v1/regions/{dong_code}/commercial
GET    /api/v1/regions/{dong_code}/real-estate

GET    /api/v1/map/clinics?lat=37.5&lng=127.0&radius=2000
GET    /api/v1/map/heatmap?type=population|competition|cost

POST   /api/v1/analysis/location    -- 입지 분석 요청
POST   /api/v1/analysis/investment  -- 투자금 시뮬레이션
POST   /api/v1/analysis/compare     -- 개업 vs 인수 비교
GET    /api/v1/analysis/report/{report_id}

POST   /api/v1/users/register
POST   /api/v1/users/login
GET    /api/v1/users/profile
PUT    /api/v1/users/profile

GET    /api/v1/listings             -- 인수 매물 목록
GET    /api/v1/listings/{id}
```
