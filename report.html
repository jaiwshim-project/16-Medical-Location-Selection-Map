<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>AI ì…ì§€ë¶„ì„ ë¦¬í¬íŠ¸ â€” ë´íƒˆë§µAI ì¹˜ê³¼ê°œì› ì…ì§€ë¶„ì„</title>
<script src="https://cdn.tailwindcss.com"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9/dist/web/variable/pretendardvariable-dynamic-subset.min.css">
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css">
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script>tailwind.config={theme:{extend:{fontFamily:{sans:['Pretendard Variable','Pretendard','system-ui','sans-serif']}}}}</script>
<style>
html{scroll-behavior:smooth}
body{font-family:'Pretendard Variable','Pretendard',system-ui,sans-serif}
@keyframes fadeIn{from{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}
@keyframes fadeInUp{from{opacity:0;transform:translateY(30px)}to{opacity:1;transform:translateY(0)}}
@keyframes slideIn{from{opacity:0;transform:translateX(-20px)}to{opacity:1;transform:translateX(0)}}
@keyframes pulse-ring{0%{transform:scale(.8);opacity:.5}50%{transform:scale(1.2);opacity:0}100%{transform:scale(.8);opacity:.5}}
@keyframes marker-pulse{0%,100%{box-shadow:0 0 0 0 rgba(245,158,11,0.5)}70%{box-shadow:0 0 0 12px rgba(245,158,11,0)}}
@keyframes loadBar{0%{width:0}100%{width:100%}}
@keyframes count-up{from{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}
.fade-in{animation:fadeIn .6s ease-out forwards;opacity:0}
.fade-in-1{animation-delay:.1s}.fade-in-2{animation-delay:.2s}.fade-in-3{animation-delay:.3s}
.fade-in-4{animation-delay:.4s}.fade-in-5{animation-delay:.5s}.fade-in-6{animation-delay:.6s}
.fade-in-7{animation-delay:.7s}.fade-in-8{animation-delay:.8s}.fade-in-9{animation-delay:.9s}
.fade-in-10{animation-delay:1s}
.leaflet-container{font-family:'Pretendard Variable',sans-serif;z-index:0}
.map-legend{background:white;border-radius:10px;box-shadow:0 2px 12px rgba(0,0,0,.15);padding:0;font-size:12px;max-width:200px;color:#374151;overflow:hidden}
.map-legend h4{font-size:12px;font-weight:700;margin:0;padding:8px 12px;background:#f9fafb;border-bottom:1px solid #e5e7eb;cursor:pointer;display:flex;align-items:center;justify-content:space-between;user-select:none}
.map-legend h4 .leg-arrow{transition:transform .2s;font-size:10px}
.map-legend.collapsed h4 .leg-arrow{transform:rotate(-90deg)}
.map-legend.collapsed .leg-body{display:none}
.map-legend .leg-body{padding:8px 12px 10px;max-height:300px;overflow-y:auto;scrollbar-width:thin}
.map-legend .leg-section{margin-top:6px;padding-top:5px;border-top:1px solid #f3f4f6}
.map-legend .leg-section:first-of-type{margin-top:0;padding-top:0;border-top:none}
.map-legend .leg-title{font-size:10px;font-weight:700;color:#6b7280;letter-spacing:.5px;margin-bottom:3px}
.map-legend .leg-row{display:flex;align-items:center;gap:5px;margin:1px 0;font-size:11px}
.map-legend .leg-dot{width:10px;height:10px;border-radius:50%;border:1.5px solid white;box-shadow:0 1px 2px rgba(0,0,0,.2);flex-shrink:0}
.clinic-scroll{}
@media print{
  header,footer,.no-print{display:none!important}
  *{-webkit-print-color-adjust:exact!important;print-color-adjust:exact!important;color-adjust:exact!important}
  body{background:white!important}
  html,body{width:100%!important;margin:0!important;padding:0!important}
  @page{size:A4;margin:10mm 8mm 14mm 8mm;@bottom-right{content:counter(page)" / "counter(pages);font-size:9px;color:#9ca3af;font-family:'Pretendard Variable',sans-serif}}
  .fade-in,.fade-in-1,.fade-in-2,.fade-in-3,.fade-in-4,.fade-in-5,.fade-in-6,.fade-in-7,.fade-in-8,.fade-in-9,.fade-in-10{opacity:1!important;transform:none!important;animation:none!important}
  section{break-inside:avoid;page-break-inside:avoid}
  .leaflet-container{height:400px!important}
  [class*="shadow"]{box-shadow:none!important}
  [class*="backdrop-blur"]{-webkit-backdrop-filter:none!important;backdrop-filter:none!important}
  [class*="bg-white/10"],[class*="bg-white/5"]{background:rgba(255,255,255,0.25)!important}
  .bg-gradient-to-br.from-slate-900{background:linear-gradient(to bottom right,#0f172a,#1e3a5f,#1e293b)!important}
}
</style>
</head>
<body class="antialiased bg-gray-50 text-gray-900">

<!-- HEADER -->
<header class="sticky top-0 z-50 bg-sky-100/90 backdrop-blur border-b border-sky-200 no-print">
<div class="max-w-7xl mx-auto px-6 h-16 flex items-center justify-between">
<a href="index.html" class="flex items-center gap-2"><div class="w-8 h-8 bg-blue-600 rounded-lg flex items-center justify-center"><span class="text-white font-bold text-sm">D</span></div><span class="font-bold text-lg text-blue-900">ë´íƒˆë§µAI <span class="text-base font-semibold text-blue-600">ì¹˜ê³¼ê°œì› ì…ì§€ë¶„ì„</span></span></a>
<nav class="hidden md:flex items-center gap-8">
<a href="analysis.html" class="text-sm font-medium text-blue-800 hover:text-blue-950 transition">ì…ì§€ë¶„ì„</a>
<a href="map.html" class="text-sm font-medium text-blue-800 hover:text-blue-950 transition">ì§€ë„ íƒìƒ‰</a>
<a href="pricing.html" class="text-sm font-medium text-blue-800 hover:text-blue-950 transition">ìš”ê¸ˆì œ</a>
<a href="reports.html" class="text-sm font-medium text-blue-800 hover:text-blue-950 transition">ë¦¬í¬íŠ¸</a>
<a href="promo.html" class="text-sm font-medium text-blue-800 hover:text-blue-950 transition">í™ë³´</a>
<a href="faq.html" class="text-sm font-medium text-blue-800 hover:text-blue-950 transition">FAQ</a>
<a href="manual.html" class="text-sm font-medium text-blue-800 hover:text-blue-950 transition">ì‚¬ìš©ì ë§¤ë‰´ì–¼</a>
</nav>
<div class="hidden md:flex items-center gap-3"><a href="map.html" class="bg-blue-600 text-white text-sm font-semibold px-4 py-2 rounded-lg hover:bg-blue-700 transition">ë°”ë¡œ ì²´í—˜í•˜ê¸°</a></div>
<button class="md:hidden p-2 text-blue-800" onclick="document.getElementById('mobile-menu').classList.toggle('hidden')"><svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/></svg></button>
</div>
<div id="mobile-menu" class="hidden md:hidden border-t border-sky-200 bg-sky-50 px-6 py-4 space-y-3">
<a href="analysis.html" class="block text-blue-800 font-medium py-2">ì…ì§€ë¶„ì„</a>
<a href="map.html" class="block text-blue-800 font-medium py-2">ì§€ë„ íƒìƒ‰</a>
<a href="pricing.html" class="block text-blue-800 font-medium py-2">ìš”ê¸ˆì œ</a>
<a href="reports.html" class="block text-blue-800 font-medium py-2">ë¦¬í¬íŠ¸</a>
<a href="promo.html" class="block text-blue-800 font-medium py-2">í™ë³´</a>
<a href="faq.html" class="block text-blue-800 font-medium py-2">FAQ</a>
<a href="manual.html" class="block text-blue-800 font-medium py-2">ì‚¬ìš©ì ë§¤ë‰´ì–¼</a>
<hr class="border-gray-100">
<a href="map.html" class="block bg-blue-600 text-white text-center py-2.5 rounded-lg font-semibold">ë°”ë¡œ ì²´í—˜í•˜ê¸°</a>
</div>
</header>

<main>
<div id="report-root"></div>
</main>

<!-- FOOTER -->
<footer class="bg-gray-900 text-gray-400 py-12 no-print"><div class="max-w-7xl mx-auto px-6">
<div class="grid md:grid-cols-4 gap-8">
<div><div class="flex items-center gap-2 mb-3"><div class="w-7 h-7 bg-blue-600 rounded-lg flex items-center justify-center"><span class="text-white font-bold text-xs">D</span></div><span class="font-bold text-white">ë´íƒˆë§µAI <span class="text-sm font-medium text-gray-300">ì¹˜ê³¼ê°œì› ì…ì§€ë¶„ì„</span></span></div><p class="text-sm">ë°ì´í„°ë¡œ ì°¾ëŠ” ìµœì ì˜ ì¹˜ê³¼ ê°œì› ì…ì§€</p></div>
<div><h3 class="text-white font-semibold mb-3 text-sm">ì„œë¹„ìŠ¤</h3><div class="space-y-2 text-sm"><a href="analysis.html" class="block hover:text-white transition">ì…ì§€ë¶„ì„</a><a href="map.html" class="block hover:text-white transition">ì§€ë„ íƒìƒ‰</a><a href="pricing.html" class="block hover:text-white transition">ìš”ê¸ˆì œ</a></div></div>
<div><h3 class="text-white font-semibold mb-3 text-sm">ì§€ì›</h3><div class="space-y-2 text-sm"><a href="faq.html" class="block hover:text-white transition">ìì£¼ ë¬»ëŠ” ì§ˆë¬¸</a><a href="manual.html" class="block hover:text-white transition">ì‚¬ìš©ì ë§¤ë‰´ì–¼</a><a href="index.html" class="block hover:text-white transition">í™ˆìœ¼ë¡œ</a></div></div>
<div><h3 class="text-white font-semibold mb-3 text-sm">ì—°ë½ì²˜</h3><div class="space-y-2 text-sm"><p>ì‹¬ì¬ìš° ëŒ€í‘œ</p><p><a href="mailto:jaiwshim@gmail.com" class="hover:text-white">jaiwshim@gmail.com</a></p><p><a href="tel:010-2397-5734" class="hover:text-white">010-2397-5734</a></p></div></div>
</div>
<div class="border-t border-gray-800 mt-8 pt-8 text-xs"><p>ë´íƒˆë§µAI ì¹˜ê³¼ê°œì› ì…ì§€ë¶„ì„ | ì‹¬ì¬ìš° ëŒ€í‘œ</p><p class="mt-1">ë¬¸ì˜: <a href="mailto:jaiwshim@gmail.com" class="text-gray-400 hover:text-white">jaiwshim@gmail.com</a> Â· <a href="tel:010-2397-5734" class="text-gray-400 hover:text-white">010-2397-5734</a></p><p class="mt-2">&copy; 2025 DentalMap. All rights reserved.</p><p class="mt-2 text-gray-600">ë³¸ ì„œë¹„ìŠ¤ì˜ ë¶„ì„ ê²°ê³¼ëŠ” ì°¸ê³ ìš©ì´ë©°, íˆ¬ì ê²°ì •ì— ëŒ€í•œ ë²•ì  ì±…ì„ì„ ì§€ì§€ ì•ŠìŠµë‹ˆë‹¤.</p></div>
</div></footer>

<script>
/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   MOCK DATA & UTILITIES
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
const REGIONS=[
{dong_code:"1168010100",sido:"ì„œìš¸",sigungu:"ê°•ë‚¨êµ¬",dong:"ì—­ì‚¼ë™",population:32450,age_20_39_pct:35,age_40_59_pct:28,age_60_plus_pct:19,dental_count:12,pop_per_clinic:2704,avg_rent_pyeong:18,area_pyeong:40,subway_station:"ì—­ì‚¼ì—­",subway_line:"2í˜¸ì„ ",subway_walk_min:3,bus_stops_500m:8,daily_floating:85000,pop_growth_rate:1.2,commercial_grade:"A",scores:{population:82,competition:55,cost:48,access:91,growth:68,total:72},grade:"B",lat:37.5007,lng:127.0365},
{dong_code:"1165010700",sido:"ì„œìš¸",sigungu:"ì„œì´ˆêµ¬",dong:"ì„œì´ˆë™",population:28300,age_20_39_pct:32,age_40_59_pct:30,age_60_plus_pct:20,dental_count:15,pop_per_clinic:1887,avg_rent_pyeong:20,area_pyeong:40,subway_station:"ì„œì´ˆì—­",subway_line:"2í˜¸ì„ ",subway_walk_min:5,bus_stops_500m:6,daily_floating:72000,pop_growth_rate:0.8,commercial_grade:"A",scores:{population:75,competition:42,cost:40,access:85,growth:60,total:63},grade:"C",lat:37.4837,lng:127.0073},
{dong_code:"4146310100",sido:"ê²½ê¸°",sigungu:"ì„±ë‚¨ì‹œ ë¶„ë‹¹êµ¬",dong:"íŒêµë™",population:41200,age_20_39_pct:40,age_40_59_pct:32,age_60_plus_pct:10,dental_count:8,pop_per_clinic:5150,avg_rent_pyeong:12,area_pyeong:40,subway_station:"íŒêµì—­",subway_line:"ì‹ ë¶„ë‹¹ì„ ",subway_walk_min:7,bus_stops_500m:5,daily_floating:95000,pop_growth_rate:5.8,commercial_grade:"A",scores:{population:90,competition:82,cost:72,access:75,growth:95,total:85},grade:"A",lat:37.3948,lng:127.1112},
{dong_code:"1120010300",sido:"ì„œìš¸",sigungu:"ì„±ë™êµ¬",dong:"ì„±ìˆ˜ë™",population:25600,age_20_39_pct:42,age_40_59_pct:25,age_60_plus_pct:15,dental_count:6,pop_per_clinic:4267,avg_rent_pyeong:14,area_pyeong:35,subway_station:"ì„±ìˆ˜ì—­",subway_line:"2í˜¸ì„ ",subway_walk_min:4,bus_stops_500m:7,daily_floating:68000,pop_growth_rate:4.2,commercial_grade:"B",scores:{population:78,competition:78,cost:65,access:88,growth:88,total:79},grade:"B",lat:37.5445,lng:127.0564},
{dong_code:"1174010100",sido:"ì„œìš¸",sigungu:"ë§ˆí¬êµ¬",dong:"í•©ì •ë™",population:19800,age_20_39_pct:45,age_40_59_pct:22,age_60_plus_pct:14,dental_count:7,pop_per_clinic:2829,avg_rent_pyeong:13,area_pyeong:30,subway_station:"í•©ì •ì—­",subway_line:"2Â·6í˜¸ì„ ",subway_walk_min:2,bus_stops_500m:9,daily_floating:62000,pop_growth_rate:3.1,commercial_grade:"B",scores:{population:68,competition:65,cost:68,access:95,growth:82,total:74},grade:"B",lat:37.5496,lng:126.9139},
{dong_code:"4111710100",sido:"ê²½ê¸°",sigungu:"ìˆ˜ì›ì‹œ ì˜í†µêµ¬",dong:"ê´‘êµë™",population:52000,age_20_39_pct:38,age_40_59_pct:35,age_60_plus_pct:8,dental_count:10,pop_per_clinic:5200,avg_rent_pyeong:10,area_pyeong:45,subway_station:"ê´‘êµì—­",subway_line:"ì‹ ë¶„ë‹¹ì„ ",subway_walk_min:8,bus_stops_500m:4,daily_floating:45000,pop_growth_rate:7.2,commercial_grade:"B",scores:{population:92,competition:85,cost:80,access:68,growth:98,total:87},grade:"A",lat:37.2935,lng:127.0454},
{dong_code:"3020011200",sido:"ëŒ€ì „",sigungu:"ìœ ì„±êµ¬",dong:"ë´‰ëª…ë™",population:35800,age_20_39_pct:36,age_40_59_pct:28,age_60_plus_pct:16,dental_count:9,pop_per_clinic:3978,avg_rent_pyeong:8,area_pyeong:40,subway_station:"ì‹œì²­ì—­",subway_line:"1í˜¸ì„ ",subway_walk_min:10,bus_stops_500m:6,daily_floating:38000,pop_growth_rate:2.5,commercial_grade:"B",scores:{population:80,competition:72,cost:88,access:62,growth:75,total:77},grade:"B",lat:36.3623,lng:127.3561},
{dong_code:"2644010100",sido:"ë¶€ì‚°",sigungu:"í•´ìš´ëŒ€êµ¬",dong:"ìš°ë™",population:48500,age_20_39_pct:30,age_40_59_pct:32,age_60_plus_pct:18,dental_count:14,pop_per_clinic:3464,avg_rent_pyeong:11,area_pyeong:40,subway_station:"í•´ìš´ëŒ€ì—­",subway_line:"2í˜¸ì„ ",subway_walk_min:6,bus_stops_500m:7,daily_floating:55000,pop_growth_rate:1.5,commercial_grade:"A",scores:{population:85,competition:60,cost:75,access:78,growth:65,total:74},grade:"B",lat:35.1631,lng:129.1636},
{dong_code:"1171010100",sido:"ì„œìš¸",sigungu:"ì†¡íŒŒêµ¬",dong:"ì ì‹¤ë™",population:38700,age_20_39_pct:33,age_40_59_pct:30,age_60_plus_pct:17,dental_count:11,pop_per_clinic:3518,avg_rent_pyeong:15,area_pyeong:40,subway_station:"ì ì‹¤ì—­",subway_line:"2Â·8í˜¸ì„ ",subway_walk_min:3,bus_stops_500m:9,daily_floating:92000,pop_growth_rate:1.8,commercial_grade:"A",scores:{population:84,competition:62,cost:55,access:92,growth:70,total:74},grade:"B",lat:37.5133,lng:127.1001}
];

function fmt(n){return new Intl.NumberFormat('ko-KR').format(n)}
function getGradeColor(g){return{S:'text-purple-600 bg-purple-50',A:'text-blue-600 bg-blue-50',B:'text-green-600 bg-green-50',C:'text-yellow-600 bg-yellow-50',D:'text-orange-600 bg-orange-50'}[g]||'text-red-600 bg-red-50'}
function getScoreColor(s){return s>=80?'text-blue-600':s>=60?'text-green-600':s>=40?'text-yellow-600':'text-red-500'}
function getScoreBarColor(s){return s>=80?'bg-blue-500':s>=60?'bg-green-500':s>=40?'bg-yellow-500':'bg-red-500'}
function fmtRevKr(v){return v>=10000?((v/10000).toFixed(1)+'ì–µ'):(fmt(v)+'ë§Œ')}
function hashStr(s){let h=0;for(let i=0;i<s.length;i++){h=((h<<5)-h)+s.charCodeAt(i);h|=0}return Math.abs(h)}
function seededRand(seed,min,max){seed=(seed*9301+49297)%233280;return min+Math.floor((seed/233280)*(max-min+1))}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   GEO RESOLUTION
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function resolveGeoFromName(name){
  const areas=[
    {kw:['ëŒ€ì „'],lat:36.3504,lng:126.3845,sido:'ëŒ€ì „ê´‘ì—­ì‹œ',gu:[{kw:'ì¤‘êµ¬',lat:36.3254,lng:127.4214},{kw:'ì„œêµ¬',lat:36.3555,lng:127.3835},{kw:'ë™êµ¬',lat:36.3121,lng:127.4549},{kw:'ìœ ì„±êµ¬',lat:36.3622,lng:127.3561},{kw:'ëŒ€ë•êµ¬',lat:36.3467,lng:127.4153}]},
    {kw:['ì„œìš¸'],lat:37.5665,lng:126.978,sido:'ì„œìš¸íŠ¹ë³„ì‹œ',gu:[{kw:'ê°•ë‚¨êµ¬',lat:37.5172,lng:127.0473},{kw:'ì„œì´ˆêµ¬',lat:37.4837,lng:127.0324},{kw:'ì†¡íŒŒêµ¬',lat:37.5145,lng:127.1050},{kw:'ê°•ë™êµ¬',lat:37.5301,lng:127.1238},{kw:'ë§ˆí¬êµ¬',lat:37.5664,lng:126.9018},{kw:'ìš©ì‚°êµ¬',lat:37.5326,lng:126.9906},{kw:'ì¢…ë¡œêµ¬',lat:37.5735,lng:126.9790},{kw:'ì¤‘êµ¬',lat:37.5641,lng:126.9979},{kw:'ì˜ë“±í¬êµ¬',lat:37.5264,lng:126.8963},{kw:'ê°•ì„œêµ¬',lat:37.5510,lng:126.8495},{kw:'êµ¬ë¡œêµ¬',lat:37.4954,lng:126.8874},{kw:'ê´€ì•…êµ¬',lat:37.4784,lng:126.9516},{kw:'ë™ì‘êµ¬',lat:37.5124,lng:126.9393},{kw:'ì„±ë™êµ¬',lat:37.5634,lng:127.0369},{kw:'ê´‘ì§„êµ¬',lat:37.5385,lng:127.0823},{kw:'ë™ëŒ€ë¬¸êµ¬',lat:37.5744,lng:127.0396},{kw:'ì¤‘ë‘êµ¬',lat:37.6063,lng:127.0926},{kw:'ì„±ë¶êµ¬',lat:37.5894,lng:127.0164},{kw:'ê°•ë¶êµ¬',lat:37.6397,lng:127.0253},{kw:'ë„ë´‰êµ¬',lat:37.6688,lng:127.0471},{kw:'ë…¸ì›êµ¬',lat:37.6542,lng:127.0568},{kw:'ì€í‰êµ¬',lat:37.6027,lng:126.9291},{kw:'ì„œëŒ€ë¬¸êµ¬',lat:37.5791,lng:126.9368},{kw:'ì–‘ì²œêµ¬',lat:37.5170,lng:126.8664},{kw:'ê¸ˆì²œêµ¬',lat:37.4569,lng:126.8955}]},
    {kw:['ë¶€ì‚°'],lat:35.1796,lng:129.0756,sido:'ë¶€ì‚°ê´‘ì—­ì‹œ',gu:[{kw:'í•´ìš´ëŒ€êµ¬',lat:35.1631,lng:129.1636},{kw:'ë¶€ì‚°ì§„êµ¬',lat:35.1631,lng:129.0533},{kw:'ë™ë˜êµ¬',lat:35.2050,lng:129.0858},{kw:'ë‚¨êµ¬',lat:35.1368,lng:129.0845},{kw:'ì¤‘êµ¬',lat:35.1060,lng:129.0325},{kw:'ì„œêµ¬',lat:35.0982,lng:129.0244},{kw:'ë¶êµ¬',lat:35.1974,lng:129.0312},{kw:'ì‚¬ìƒêµ¬',lat:35.1526,lng:128.9912},{kw:'ì—°ì œêµ¬',lat:35.1762,lng:129.0801},{kw:'ìˆ˜ì˜êµ¬',lat:35.1458,lng:129.1133},{kw:'ê¸ˆì •êµ¬',lat:35.2432,lng:129.0913},{kw:'ì‚¬í•˜êµ¬',lat:35.1046,lng:128.9747},{kw:'ê°•ì„œêµ¬',lat:35.2121,lng:128.9809}]},
    {kw:['ì¸ì²œ'],lat:37.4563,lng:126.7052,sido:'ì¸ì²œê´‘ì—­ì‹œ',gu:[{kw:'ë‚¨ë™êµ¬',lat:37.4488,lng:126.7369},{kw:'ë¶€í‰êµ¬',lat:37.5076,lng:126.7219},{kw:'ì—°ìˆ˜êµ¬',lat:37.4101,lng:126.6783},{kw:'ì„œêµ¬',lat:37.5451,lng:126.6760},{kw:'ì¤‘êµ¬',lat:37.4738,lng:126.6217},{kw:'ë¯¸ì¶”í™€êµ¬',lat:37.4421,lng:126.6993},{kw:'ê³„ì–‘êµ¬',lat:37.5372,lng:126.7376}]},
    {kw:['ëŒ€êµ¬'],lat:35.8714,lng:128.6014,sido:'ëŒ€êµ¬ê´‘ì—­ì‹œ',gu:[{kw:'ì¤‘êµ¬',lat:35.8694,lng:128.6064},{kw:'ìˆ˜ì„±êµ¬',lat:35.8583,lng:128.6315},{kw:'ë‹¬ì„œêµ¬',lat:35.8299,lng:128.5327},{kw:'ë¶êµ¬',lat:35.8858,lng:128.5828},{kw:'ë™êµ¬',lat:35.8864,lng:128.6355},{kw:'ì„œêµ¬',lat:35.8718,lng:128.5592},{kw:'ë‚¨êµ¬',lat:35.8460,lng:128.5975}]},
    {kw:['ê´‘ì£¼'],lat:35.1595,lng:126.8526,sido:'ê´‘ì£¼ê´‘ì—­ì‹œ',gu:[{kw:'ì„œêµ¬',lat:35.1522,lng:126.8895},{kw:'ë¶êµ¬',lat:35.1744,lng:126.9120},{kw:'ë‚¨êµ¬',lat:35.1326,lng:126.9024},{kw:'ë™êµ¬',lat:35.1461,lng:126.9231},{kw:'ê´‘ì‚°êµ¬',lat:35.1395,lng:126.7938}]},
    {kw:['ìš¸ì‚°'],lat:35.5384,lng:129.3114,sido:'ìš¸ì‚°ê´‘ì—­ì‹œ',gu:[{kw:'ë‚¨êµ¬',lat:35.5444,lng:129.3303},{kw:'ì¤‘êµ¬',lat:35.5694,lng:129.3327},{kw:'ë™êµ¬',lat:35.5050,lng:129.4166},{kw:'ë¶êµ¬',lat:35.5826,lng:129.3610},{kw:'ìš¸ì£¼êµ°',lat:35.5224,lng:129.2441}]},
    {kw:['ì„¸ì¢…'],lat:36.4801,lng:126.9270,sido:'ì„¸ì¢…íŠ¹ë³„ìì¹˜ì‹œ',gu:[]},
    {kw:['ìˆ˜ì›'],lat:37.2636,lng:127.0286,sido:'ê²½ê¸°ë„',gu:[{kw:'ì˜í†µêµ¬',lat:37.2596,lng:127.0462},{kw:'íŒ”ë‹¬êµ¬',lat:37.2829,lng:127.0204},{kw:'ì¥ì•ˆêµ¬',lat:37.3038,lng:127.0101},{kw:'ê¶Œì„ êµ¬',lat:37.2572,lng:126.9719}]},
    {kw:['ì„±ë‚¨'],lat:37.4200,lng:127.1267,sido:'ê²½ê¸°ë„',gu:[{kw:'ë¶„ë‹¹êµ¬',lat:37.3825,lng:127.1188},{kw:'ìˆ˜ì •êµ¬',lat:37.4504,lng:127.1457},{kw:'ì¤‘ì›êµ¬',lat:37.4317,lng:127.1372}]},
    {kw:['ê³ ì–‘'],lat:37.6584,lng:126.8320,sido:'ê²½ê¸°ë„',gu:[{kw:'ì¼ì‚°ë™êµ¬',lat:37.6586,lng:126.7742},{kw:'ì¼ì‚°ì„œêµ¬',lat:37.6756,lng:126.7513},{kw:'ë•ì–‘êµ¬',lat:37.6376,lng:126.8320}]},
    {kw:['ìš©ì¸'],lat:37.2411,lng:127.1775,sido:'ê²½ê¸°ë„',gu:[{kw:'ìˆ˜ì§€êµ¬',lat:37.3219,lng:127.0981},{kw:'ê¸°í¥êµ¬',lat:37.2802,lng:127.1151},{kw:'ì²˜ì¸êµ¬',lat:37.2342,lng:127.2019}]},
    {kw:['ì°½ì›'],lat:35.2280,lng:128.6811,sido:'ê²½ìƒë‚¨ë„',gu:[{kw:'ì„±ì‚°êµ¬',lat:35.1989,lng:128.7119},{kw:'ì˜ì°½êµ¬',lat:35.2538,lng:128.6389},{kw:'ë§ˆì‚°í•©í¬êµ¬',lat:35.1855,lng:128.5683},{kw:'ë§ˆì‚°íšŒì›êµ¬',lat:35.2215,lng:128.5813},{kw:'ì§„í•´êµ¬',lat:35.1336,lng:128.7107}]},
    {kw:['ì²­ì£¼'],lat:36.6424,lng:127.4890,sido:'ì¶©ì²­ë¶ë„',gu:[{kw:'í¥ë•êµ¬',lat:36.6373,lng:127.4329},{kw:'ì„œì›êµ¬',lat:36.6093,lng:127.4712},{kw:'ìƒë‹¹êµ¬',lat:36.6539,lng:127.4901},{kw:'ì²­ì›êµ¬',lat:36.6952,lng:127.4879}]},
    {kw:['ì „ì£¼'],lat:35.8242,lng:127.1480,sido:'ì „ë¼ë¶ë„',gu:[{kw:'ì™„ì‚°êµ¬',lat:35.8123,lng:127.1365},{kw:'ë•ì§„êµ¬',lat:35.8423,lng:127.1344}]},
    {kw:['ì²œì•ˆ'],lat:36.8151,lng:127.1139,sido:'ì¶©ì²­ë‚¨ë„',gu:[{kw:'ì„œë¶êµ¬',lat:36.8502,lng:127.1435},{kw:'ë™ë‚¨êµ¬',lat:36.7889,lng:127.1652}]},
    {kw:['ì•ˆì‚°'],lat:37.3219,lng:126.8309,sido:'ê²½ê¸°ë„',gu:[{kw:'ìƒë¡êµ¬',lat:37.3004,lng:126.8461},{kw:'ë‹¨ì›êµ¬',lat:37.3184,lng:126.7962}]},
    {kw:['ì•ˆì–‘'],lat:37.3943,lng:126.9568,sido:'ê²½ê¸°ë„',gu:[{kw:'ë§Œì•ˆêµ¬',lat:37.3866,lng:126.9327},{kw:'ë™ì•ˆêµ¬',lat:37.3929,lng:126.9517}]},
    {kw:['ì œì£¼'],lat:33.4996,lng:126.5312,sido:'ì œì£¼íŠ¹ë³„ìì¹˜ë„',gu:[{kw:'ì œì£¼ì‹œ',lat:33.5100,lng:126.5219},{kw:'ì„œê·€í¬ì‹œ',lat:33.2532,lng:126.5597}]},
    {kw:['í¬í•­'],lat:36.0190,lng:129.3435,sido:'ê²½ìƒë¶ë„',gu:[{kw:'ë‚¨êµ¬',lat:35.9987,lng:129.3652},{kw:'ë¶êµ¬',lat:36.0441,lng:129.3719}]},
    {kw:['ê¹€í•´'],lat:35.2285,lng:128.8894,sido:'ê²½ìƒë‚¨ë„',gu:[]},{kw:['í‰íƒ'],lat:36.9921,lng:127.0866,sido:'ê²½ê¸°ë„',gu:[]},{kw:['íŒŒì£¼'],lat:37.7599,lng:126.7801,sido:'ê²½ê¸°ë„',gu:[]},{kw:['ì‹œí¥'],lat:37.3800,lng:126.8028,sido:'ê²½ê¸°ë„',gu:[]},{kw:['í™”ì„±'],lat:37.1994,lng:126.8313,sido:'ê²½ê¸°ë„',gu:[]},{kw:['ê¹€í¬'],lat:37.6152,lng:126.7156,sido:'ê²½ê¸°ë„',gu:[]},{kw:['ê´‘ëª…'],lat:37.4786,lng:126.8645,sido:'ê²½ê¸°ë„',gu:[]},{kw:['êµ°í¬'],lat:37.3614,lng:126.9352,sido:'ê²½ê¸°ë„',gu:[]},{kw:['í•˜ë‚¨'],lat:37.5393,lng:127.2147,sido:'ê²½ê¸°ë„',gu:[]},{kw:['ì–‘ì‚°'],lat:35.3350,lng:129.0372,sido:'ê²½ìƒë‚¨ë„',gu:[]},{kw:['êµ¬ë¯¸'],lat:36.1197,lng:128.3440,sido:'ê²½ìƒë¶ë„',gu:[]},{kw:['ì¶˜ì²œ'],lat:37.8813,lng:127.7300,sido:'ê°•ì›íŠ¹ë³„ìì¹˜ë„',gu:[]},{kw:['ì›ì£¼'],lat:37.3423,lng:127.9202,sido:'ê°•ì›íŠ¹ë³„ìì¹˜ë„',gu:[]},{kw:['ê°•ë¦‰'],lat:37.7519,lng:128.8761,sido:'ê°•ì›íŠ¹ë³„ìì¹˜ë„',gu:[]},{kw:['ì—¬ìˆ˜'],lat:34.7604,lng:127.6622,sido:'ì „ë¼ë‚¨ë„',gu:[]},{kw:['ìˆœì²œ'],lat:34.9506,lng:127.4872,sido:'ì „ë¼ë‚¨ë„',gu:[]},{kw:['ëª©í¬'],lat:34.8118,lng:126.3922,sido:'ì „ë¼ë‚¨ë„',gu:[]},{kw:['ìµì‚°'],lat:35.9483,lng:126.9577,sido:'ì „ë¼ë¶ë„',gu:[]},{kw:['êµ°ì‚°'],lat:35.9674,lng:126.7369,sido:'ì „ë¼ë¶ë„',gu:[]},{kw:['ê²½ì£¼'],lat:35.8562,lng:129.2247,sido:'ê²½ìƒë¶ë„',gu:[]},{kw:['ê±°ì œ'],lat:34.8806,lng:128.6213,sido:'ê²½ìƒë‚¨ë„',gu:[]},{kw:['ì–‘ì£¼'],lat:37.7854,lng:127.0456,sido:'ê²½ê¸°ë„',gu:[]},{kw:['ì˜ì •ë¶€'],lat:37.7381,lng:127.0337,sido:'ê²½ê¸°ë„',gu:[]},{kw:['ë‚¨ì–‘ì£¼'],lat:37.6360,lng:127.2163,sido:'ê²½ê¸°ë„',gu:[]},{kw:['ì´ì²œ'],lat:37.2720,lng:127.4348,sido:'ê²½ê¸°ë„',gu:[]},{kw:['ì˜¤ì‚°'],lat:37.1498,lng:127.0697,sido:'ê²½ê¸°ë„',gu:[]},{kw:['ê´‘ì£¼ì‹œ','ê²½ê¸° ê´‘ì£¼'],lat:37.4095,lng:127.2551,sido:'ê²½ê¸°ë„',gu:[]},{kw:['ì¶©ì£¼'],lat:36.9910,lng:127.9259,sido:'ì¶©ì²­ë¶ë„',gu:[]},{kw:['ì•„ì‚°'],lat:36.7899,lng:127.0018,sido:'ì¶©ì²­ë‚¨ë„',gu:[]},{kw:['ì„œì‚°'],lat:36.7845,lng:126.4503,sido:'ì¶©ì²­ë‚¨ë„',gu:[]},{kw:['í™ëŒ€','í™ëŒ€ì…êµ¬'],lat:37.5563,lng:126.9237,sido:'ì„œìš¸íŠ¹ë³„ì‹œ',gu:[]},{kw:['ì ì‹¤'],lat:37.5133,lng:127.1001,sido:'ì„œìš¸íŠ¹ë³„ì‹œ',gu:[]},{kw:['ê°•ë‚¨'],lat:37.4979,lng:127.0276,sido:'ì„œìš¸íŠ¹ë³„ì‹œ',gu:[]},{kw:['íŒêµ'],lat:37.3947,lng:127.1112,sido:'ê²½ê¸°ë„',gu:[]},{kw:['ì´ìˆ˜','ì´ìˆ˜ì—­'],lat:37.4856,lng:126.9818,sido:'ì„œìš¸íŠ¹ë³„ì‹œ',gu:[{kw:'ë™ì‘êµ¬',lat:37.5124,lng:126.9393}]}
  ];
  let baseLat=37.5665,baseLng=126.978,sido='',sigungu='';
  for(const a of areas){if(a.kw.some(k=>name.includes(k))){baseLat=a.lat;baseLng=a.lng;sido=a.sido;for(const g of a.gu){if(name.includes(g.kw)){baseLat=g.lat;baseLng=g.lng;sigungu=g.kw;break}}if(!sigungu&&a.kw[0])sigungu=a.kw[0];break}}
  return{lat:baseLat,lng:baseLng,sido:sido,sigungu:sigungu};
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   REGION GENERATION
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function generateRegion(name){
  const h=hashStr(name),r=n=>(a,b)=>seededRand(h*n+n,a,b);
  const geo=resolveGeoFromName(name);
  const pop=r(1)(15000,60000),dental=r(2)(3,18),rent=r(3)(6,22),area=r(4)(25,50),wk=r(5)(2,15),bus=r(6)(2,10),fl=r(7)(20000,100000);
  const gr=parseFloat(((r(8)(0,80)-20)/10).toFixed(1)),a20=r(9)(25,48),a40=r(10)(20,35),a60=Math.max(0,100-a20-a40);
  const ps=Math.min(100,Math.max(30,Math.round(pop/600)+r(11)(-5,5))),cs=Math.min(100,Math.max(20,100-dental*5+r(12)(-5,10)));
  const co=Math.min(100,Math.max(20,100-rent*3+r(13)(-5,5))),ac=Math.min(100,Math.max(30,100-wk*4+bus*3+r(14)(-5,5)));
  const gs=Math.min(100,Math.max(20,50+Math.round(gr*8)+r(15)(-5,5)));
  const tot=Math.round(ps*0.25+cs*0.25+co*0.2+ac*0.15+gs*0.15);
  const gd=tot>=80?'A':tot>=70?'B':tot>=60?'C':'D';
  const localStations=geo.sido.includes('ëŒ€ì „')?['ëŒ€ì „ì—­','ìœ ì„±ì˜¨ì²œì—­','íƒ„ë°©ì—­','ì‹œì²­ì—­','ì¤‘ì•™ë¡œì—­']:geo.sido.includes('ë¶€ì‚°')?['ì„œë©´ì—­','í•´ìš´ëŒ€ì—­','ë¶€ì‚°ì—­','ë‚¨í¬ë™ì—­','ì„¼í…€ì‹œí‹°ì—­']:geo.sido.includes('ëŒ€êµ¬')?['ë°˜ì›”ë‹¹ì—­','ë™ëŒ€êµ¬ì—­','ì¤‘ì•™ë¡œì—­','ìˆ˜ì„±êµ¬ì²­ì—­','ë²”ì–´ì—­']:['ì—­ì‚¼ì—­','ê°•ë‚¨ì—­','í™ëŒ€ì…êµ¬ì—­','ì‹ ì´Œì—­','ì ì‹¤ì—­','ê±´ëŒ€ì…êµ¬ì—­','ì‚¬ë‹¹ì—­','ì™•ì‹­ë¦¬ì—­','íŒêµì—­','ìˆ˜ì›ì—­'];
  const lns=geo.sido.includes('ëŒ€ì „')?['1í˜¸ì„ ']:geo.sido.includes('ë¶€ì‚°')?['1í˜¸ì„ ','2í˜¸ì„ ']:geo.sido.includes('ëŒ€êµ¬')?['1í˜¸ì„ ','2í˜¸ì„ ']:['2í˜¸ì„ ','3í˜¸ì„ ','4í˜¸ì„ ','7í˜¸ì„ ','9í˜¸ì„ ','ì‹ ë¶„ë‹¹ì„ ','1í˜¸ì„ '];
  const cg=['A','B','C'],jitter=0.002;
  return{dong_code:'GEN'+h.toString().slice(0,7).padStart(7,'0'),sido:geo.sido,sigungu:geo.sigungu,dong:name,population:pop,age_20_39_pct:a20,age_40_59_pct:a40,age_60_plus_pct:a60,dental_count:dental,pop_per_clinic:Math.round(pop/dental),avg_rent_pyeong:rent,area_pyeong:area,subway_station:localStations[h%localStations.length],subway_line:lns[h%lns.length],subway_walk_min:wk,bus_stops_500m:bus,daily_floating:fl,pop_growth_rate:gr,commercial_grade:cg[h%cg.length],scores:{population:ps,competition:cs,cost:co,access:ac,growth:gs,total:tot},grade:gd,lat:geo.lat+((h%100)-50)*jitter/50,lng:geo.lng+((h%100)-50)*jitter/50,_generated:true};
}
function addGeneratedRegion(name){const ex=REGIONS.find(r=>r.dong===name&&r._generated);if(ex)return ex;const r=generateRegion(name);REGIONS.push(r);return r}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   TEXT GENERATOR
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function genTexts(r){
  const popText=r.scores.population>=80?'ë°˜ê²½ 1km ë‚´ ê±°ì£¼ì¸êµ¬ '+fmt(r.population)+'ëª…ìœ¼ë¡œ ì¹˜ê³¼ ìˆ˜ìš”ê°€ ì¶©ë¶„í•©ë‹ˆë‹¤. íŠ¹íˆ 20~39ì„¸ ì¸êµ¬ê°€ '+r.age_20_39_pct+'%ë¡œ ì‹¬ë¯¸Â·êµì • ì§„ë£Œ ìˆ˜ìš”ê°€ ë†’ì„ ê²ƒìœ¼ë¡œ ì˜ˆìƒë©ë‹ˆë‹¤.':r.scores.population>=50?'ê±°ì£¼ì¸êµ¬ '+fmt(r.population)+'ëª…ì€ í‰ê·  ìˆ˜ì¤€ì…ë‹ˆë‹¤. 20~39ì„¸ ë¹„ì¤‘ì´ '+r.age_20_39_pct+'%ì´ë©°, ì£¼ê°„ ìœ ë™ì¸êµ¬ '+fmt(r.daily_floating)+'ëª…ì„ í•¨ê»˜ ê³ ë ¤í•˜ë©´ ì‹¤ì§ˆ ìˆ˜ìš”ëŠ” ì–‘í˜¸í•©ë‹ˆë‹¤.':'ë°˜ê²½ 1km ê±°ì£¼ì¸êµ¬ '+fmt(r.population)+'ëª…ìœ¼ë¡œ ìˆ˜ìš” ê¸°ë°˜ì´ ë‹¤ì†Œ ì·¨ì•½í•©ë‹ˆë‹¤.';
  const compText=r.scores.competition>=70?'ë°˜ê²½ 500m ë‚´ ì¹˜ê³¼ '+r.dental_count+'ê°œë¡œ ê²½ìŸì´ ì ìŠµë‹ˆë‹¤. ì¸êµ¬ë‹¹ ì¹˜ê³¼ ë¹„ìœ¨ 1:'+fmt(r.pop_per_clinic)+'ë¡œ ì–‘í˜¸í•œ ìˆ˜ì¤€ì…ë‹ˆë‹¤.':r.scores.competition>=50?'ë°˜ê²½ 500m ë‚´ ì¹˜ê³¼ '+r.dental_count+'ê°œëŠ” í‰ê·  ìˆ˜ì¤€ì…ë‹ˆë‹¤. ì°¨ë³„í™” ì „ëµì´ í•„ìš”í•©ë‹ˆë‹¤.':'ë°˜ê²½ 500m ë‚´ ì¹˜ê³¼ '+r.dental_count+'ê°œë¡œ ê²½ìŸì´ ì¹˜ì—´í•©ë‹ˆë‹¤. ì¸êµ¬ë‹¹ ì¹˜ê³¼ 1:'+fmt(r.pop_per_clinic)+'.';
  const costText=r.scores.cost>=70?'í‰ë‹¹ ì„ëŒ€ë£Œ '+r.avg_rent_pyeong+'ë§Œì›ì€ í•©ë¦¬ì ì…ë‹ˆë‹¤. '+r.area_pyeong+'í‰ ê¸°ì¤€ ì›” '+fmt(r.avg_rent_pyeong*r.area_pyeong)+'ë§Œì›ìœ¼ë¡œ ì´ˆê¸° ë¶€ë‹´ì´ ë‚®ìŠµë‹ˆë‹¤.':r.scores.cost>=50?'í‰ë‹¹ ì„ëŒ€ë£Œ '+r.avg_rent_pyeong+'ë§Œì›ì€ ë³´í†µ ìˆ˜ì¤€ì…ë‹ˆë‹¤. ì›” '+fmt(r.avg_rent_pyeong*r.area_pyeong)+'ë§Œì› ì˜ˆìƒ.':'í‰ë‹¹ ì„ëŒ€ë£Œ '+r.avg_rent_pyeong+'ë§Œì›ì€ ë†’ì€ í¸ì…ë‹ˆë‹¤. ì›” '+fmt(r.avg_rent_pyeong*r.area_pyeong)+'ë§Œì› ì´ìƒ ì†Œìš”ë©ë‹ˆë‹¤.';
  const accessText='ê°€ì¥ ê°€ê¹Œìš´ ì—­ '+r.subway_station+'('+r.subway_line+', ë„ë³´ '+r.subway_walk_min+'ë¶„), ë°˜ê²½ 500m ë‚´ ë²„ìŠ¤ì •ë¥˜ì¥ '+r.bus_stops_500m+'ê°œ. ì¼ ìœ ë™ì¸êµ¬ '+fmt(r.daily_floating)+'ëª…ìœ¼ë¡œ '+(r.daily_floating>=50000?'ë§¤ìš° ìš°ìˆ˜í•œ':'ì–‘í˜¸í•œ')+' ì ‘ê·¼ì„±ì…ë‹ˆë‹¤.';
  const growthText=r.pop_growth_rate>3?'ì¸êµ¬ ì¦ê°€ìœ¨ +'+r.pop_growth_rate+'%ë¡œ ì„±ì¥ ì ì¬ë ¥ì´ ë§¤ìš° ë†’ìŠµë‹ˆë‹¤. ì‹ ê·œ ìˆ˜ìš” ì°½ì¶œì´ ê¸°ëŒ€ë©ë‹ˆë‹¤.':r.pop_growth_rate>0?'ì¸êµ¬ ì¦ê°€ìœ¨ +'+r.pop_growth_rate+'%ë¡œ ì™„ë§Œí•œ ì„±ì¥ì„¸ì…ë‹ˆë‹¤. ì•ˆì •ì ì¸ ìˆ˜ìš”ê°€ ìœ ì§€ë  ê²ƒìœ¼ë¡œ ë³´ì…ë‹ˆë‹¤.':'ì¸êµ¬ ë³€ë™ '+r.pop_growth_rate+'%ë¡œ ì„±ì¥ì´ ì •ì²´ë˜ì–´ ìˆìŠµë‹ˆë‹¤.';
  return{popText,compText,costText,accessText,growthText};
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   CLINIC GENERATION (from analysis.html)
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function generateNearbyClinics(r){
  const h=hashStr(r.dong_code||r.dong),cnt=r.dental_count||8,clinics=[];
  const types=['ì¼ë°˜ì¹˜ê³¼','êµì •ì¹˜ê³¼','ì†Œì•„ì¹˜ê³¼','ì„í”Œë€íŠ¸ì¹˜ê³¼','ì‹¬ë¯¸ì¹˜ê³¼','í†µí•©ì¹˜ê³¼'];
  const pfx=['ì„œìš¸','ë¯¸ì†Œ','í•´í”¼','ìŠ¤ë§ˆì¼','ì—°ì„¸','ì´ë“ ','í‘¸ë¥¸','ë§‘ì€','ìƒˆë´„','í•˜ë‚˜','ì˜¨','ë¹›','ëŠ˜','ì¢‹ì€','ë°ì€','ì°¸'];
  const dirs=['ê¹€','ì´','ë°•','ìµœ','ì •','ê°•','ì¡°','ìœ¤','ì¥','ì„','í•œ','ì˜¤','ì„œ','ì‹ ','ê¶Œ','í™©'];
  const specPool=['ì„í”Œë€íŠ¸','ì¹˜ì•„êµì •','ì‹¬ë¯¸ë³´ì² ','ì†Œì•„ì§„ë£Œ','ì‡ëª¸ì¹˜ë£Œ','ì¶©ì¹˜ì¹˜ë£Œ','ë¯¸ë°±','í„±ê´€ì ˆ','ì‚¬ë‘ë‹ˆë°œì¹˜','ì¹˜ì•„ì„±í˜•','íˆ¬ëª…êµì •','ë¼ë¯¸ë„¤ì´íŠ¸'];
  for(let i=0;i<cnt;i++){const s=h*100+i;
    const chairs=seededRand(s*29,2,8),sz=seededRand(s*41,15,60),ey=2024-seededRand(s*19,1,15);
    const yearsOpen=2024-ey;const yrFactor=Math.min(1.3,1+Math.max(0,yearsOpen-3)*0.02);
    const annRev=Math.round((chairs*7000+sz*120+seededRand(s*43,-3000,8000))*yrFactor);const monthlyRev=Math.round(annRev/12);
    const dailyPat=Math.max(5,Math.round(chairs*seededRand(s*47,3,7)+seededRand(s*51,-3,5)));
    const dentistCnt=Math.max(1,Math.round(chairs/2.5)+seededRand(s*53,-1,1));
    const hygienistCnt=Math.max(1,Math.round(chairs*0.8)+seededRand(s*57,-1,1));
    const totalStaff=dentistCnt+hygienistCnt+Math.max(1,seededRand(s*59,1,Math.round(chairs*0.5)+1));
    const insClaims=Math.round(dailyPat*22*seededRand(s*61,60,85)/100);const nonCovRatio=seededRand(s*63,25,65);
    const naverRating=(seededRand(s*67,30,50)/10).toFixed(1);
    const naverReviewCnt=Math.round(yearsOpen*seededRand(s*69,15,80)+seededRand(s*71,0,100));
    const blogExposure=seededRand(s*73,50,2000);const specCnt=seededRand(s*75,2,5);
    const specs=[];for(let j=0;j<specCnt;j++){const sp=specPool[seededRand(s*77+j*13,0,specPool.length-1)];if(!specs.includes(sp))specs.push(sp)}
    const nightWeekend=seededRand(s*79,0,2);const priceLvl=['ì €ê°€','ì¤‘ê°„','ê³ ê°€'][seededRand(s*81,0,2)];
    const threatLvl=chairs>=5&&yearsOpen>=5?'ë†’ìŒ':chairs>=3?'ë³´í†µ':'ë‚®ìŒ';
    const sameTypeNearby=seededRand(s*83,0,Math.min(4,cnt-1));
    const statusRand=seededRand(s*85,0,20);const status=statusRand>=2?'ì˜ì—…ì¤‘':statusRand===1?'íœ´ì—…':'íì—…';
    const forSale=status==='íì—…'?true:status==='íœ´ì—…'?seededRand(s*87,0,1)===1:seededRand(s*89,0,8)===0;
    const estAcqPrice=forSale?Math.round(annRev*seededRand(s*91,8,18)/10):null;
    clinics.push({name:pfx[seededRand(s*11,0,pfx.length-1)]+'ì¹˜ê³¼ì˜ì›',type:types[seededRand(s*13,0,types.length-1)],
      director:dirs[seededRand(s*17,0,dirs.length-1)]+'ì›ì¥',lat:r.lat+(seededRand(s*3,-70,70))/10000,lng:r.lng+(seededRand(s*7,-70,70))/10000,
      estYear:ey,rating:(seededRand(s*23,32,50)/10).toFixed(1),chairs:chairs,
      hasParking:seededRand(s*31,0,1)===1,floor:seededRand(s*37,1,8)+'ì¸µ',size:sz+'í‰',annualRevenue:annRev,
      monthlyRevenue:monthlyRev,dailyPatients:dailyPat,dentistCount:dentistCnt,hygienistCount:hygienistCnt,
      totalStaff:totalStaff,insuranceClaims:insClaims,nonCoverageRatio:nonCovRatio,
      naverRating:naverRating,naverReviewCount:naverReviewCnt,blogExposure:blogExposure,
      specialties:specs,nightWeekend:nightWeekend,priceLevel:priceLvl,yearsOpen:yearsOpen,
      competitionThreat:threatLvl,sameTypeNearby:sameTypeNearby,
      status:status,forSale:forSale,estimatedAcquisitionPrice:estAcqPrice})}
  return clinics;
}
function generateRecommendedSpots(r){
  const h=hashStr(r.dong+'_rec'),spots=[];
  const reasons=[['ê²½ìŸ ê³µë°± ì§€ì—­ â€” ë°˜ê²½ 300m ë‚´ ì¹˜ê³¼ ì—†ìŒ','ìœ ë™ì¸êµ¬ ë°€ì§‘ êµ¬ê°„ (ì¼ '+fmt(Math.round(r.daily_floating*0.4))+'ëª…)','ëŒ€ì¤‘êµí†µ ë„ë³´ 5ë¶„ ì´ë‚´','20~39ì„¸ ì Šì€ ì¸êµ¬ ë°€ì§‘'],['ì‹ ê·œ ì•„íŒŒíŠ¸ ë‹¨ì§€ ì¸ì ‘ (ì…ì£¼ 2ë…„ ì´ë‚´)','ì†Œì•„Â·êµì • ìˆ˜ìš” ë†’ì€ ì§€ì—­','ì„ëŒ€ë£Œ ë³¸ ì§€ì—­ ëŒ€ë¹„ 15% ì €ë ´','ì£¼ì°¨ì¥ í™•ë³´ ìš©ì´']];
  for(let i=0;i<2;i++){const s=h*50+i,angle=(seededRand(s,0,360)*Math.PI)/180,dist=seededRand(s*3,40,70)/10000;
    spots.push({lat:r.lat+Math.cos(angle)*dist,lng:r.lng+Math.sin(angle)*dist,
      label:i===0?'ì¶”ì²œ ìœ„ì¹˜ A (ìµœì )':'ì¶”ì²œ ìœ„ì¹˜ B (ëŒ€ì•ˆ)',
      score:Math.min(98,r.scores.total+seededRand(s*7,8,20)-i*5),
      grade:i===0?'S':'A',reasons:reasons[i],
      rent:Math.max(5,r.avg_rent_pyeong-seededRand(s*9,1,4)),estPop:seededRand(s*11,8000,25000)})}
  return spots;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   RADAR CHART (SVG)
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function drawRadarChart(scores){
  var sz=220,cx=sz/2,cy=sz/2,rad=80;
  var labels=['ì¸êµ¬/ìˆ˜ìš”','ê²½ìŸ','ë¹„ìš©','ì ‘ê·¼ì„±','ì„±ì¥ì„±'];
  var vals=[scores.population,scores.competition,scores.cost,scores.access,scores.growth];
  var angs=[-90,-18,54,126,198].map(function(a){return a*Math.PI/180});
  var svg='<svg viewBox="0 0 '+sz+' '+sz+'" class="w-full max-w-[240px] mx-auto">';
  [20,40,60,80,100].forEach(function(lv){var rr=rad*lv/100;var pts=angs.map(function(a){return(cx+rr*Math.cos(a))+','+(cy+rr*Math.sin(a))}).join(' ');svg+='<polygon points="'+pts+'" fill="none" stroke="#e5e7eb" stroke-width="0.5"/>';if(lv===60)svg+='<polygon points="'+pts+'" fill="none" stroke="#d1d5db" stroke-width="0.5" stroke-dasharray="3,3"/>'});
  angs.forEach(function(a){svg+='<line x1="'+cx+'" y1="'+cy+'" x2="'+(cx+rad*Math.cos(a))+'" y2="'+(cy+rad*Math.sin(a))+'" stroke="#e5e7eb" stroke-width="0.5"/>'});
  var dataPts=vals.map(function(v,i){var rr=rad*v/100;return(cx+rr*Math.cos(angs[i]))+','+(cy+rr*Math.sin(angs[i]))}).join(' ');
  svg+='<polygon points="'+dataPts+'" fill="rgba(59,130,246,0.12)" stroke="#3b82f6" stroke-width="2"/>';
  vals.forEach(function(v,i){var rr=rad*v/100;svg+='<circle cx="'+(cx+rr*Math.cos(angs[i]))+'" cy="'+(cy+rr*Math.sin(angs[i]))+'" r="4" fill="#3b82f6" stroke="white" stroke-width="1.5"/>'});
  vals.forEach(function(v,i){var lr=rad+28;var lx=cx+lr*Math.cos(angs[i]);var ly=cy+lr*Math.sin(angs[i]);
    svg+='<text x="'+lx+'" y="'+(ly-5)+'" text-anchor="middle" font-size="10" fill="#6b7280" font-weight="600">'+labels[i]+'</text>';
    svg+='<text x="'+lx+'" y="'+(ly+9)+'" text-anchor="middle" font-size="13" fill="'+(v>=80?'#2563eb':v>=60?'#16a34a':v>=40?'#ca8a04':'#dc2626')+'" font-weight="700">'+v+'</text>'});
  svg+='</svg>';return svg;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   MAP RENDERING
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
var reportMap=null;
function nightWeekendLabel(nw){return nw===2?'ì•¼ê°„+ì£¼ë§':nw===1?'ì£¼ë§ì§„ë£Œ':'í‰ì¼ë§Œ'}
function buildClinicPopup(c){
  return '<div style="min-width:240px;max-width:280px;font-family:Pretendard Variable,sans-serif;font-size:12px">'
    +'<div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:6px"><b style="font-size:13px;color:#1d4ed8">'+c.name+'</b><span style="background:'+(c.status==='ì˜ì—…ì¤‘'?'#dcfce7;color:#166534':c.status==='íœ´ì—…'?'#fef9c3;color:#854d0e':'#fee2e2;color:#991b1b')+';padding:1px 6px;border-radius:4px;font-size:10px;font-weight:600">'+c.status+'</span></div>'
    +'<div style="display:flex;flex-wrap:wrap;gap:3px;margin-bottom:6px"><span style="background:#fee2e2;color:#dc2626;padding:1px 5px;border-radius:3px;font-size:10px">'+c.type+'</span><span style="background:#e0f2fe;color:#0369a1;padding:1px 5px;border-radius:3px;font-size:10px">'+c.priceLevel+'</span></div>'
    +'<div style="color:#4b5563;font-size:11px">'
    +'<div style="display:flex;justify-content:space-between;padding:2px 0;border-bottom:1px solid #f3f4f6"><span>ì›ì¥</span><b>'+c.director+'</b></div>'
    +'<div style="display:flex;justify-content:space-between;padding:2px 0;border-bottom:1px solid #f3f4f6"><span>ê°œì›</span><b>'+c.estYear+'ë…„ ('+c.yearsOpen+'ë…„ì°¨)</b></div>'
    +'<div style="display:flex;justify-content:space-between;padding:2px 0;border-bottom:1px solid #f3f4f6"><span>ê·œëª¨</span><b>ì²´ì–´ '+c.chairs+'ëŒ€ Â· '+c.size+'</b></div>'
    +'<div style="display:flex;justify-content:space-between;padding:2px 0;border-bottom:1px solid #f3f4f6"><span>ì¼í™˜ì</span><b>'+c.dailyPatients+'ëª…</b></div>'
    +'<div style="display:flex;justify-content:space-between;padding:2px 0;border-bottom:1px solid #f3f4f6"><span>í‰ì </span><b style="color:#f59e0b">â˜… '+c.naverRating+'</b></div>'
    +'</div>'
    +'<div style="margin-top:5px;padding-top:5px;border-top:1px solid #e5e7eb;background:#ecfdf5;margin:5px -8px -8px;padding:6px 8px;border-radius:0 0 4px 4px">'
    +'<div style="display:flex;justify-content:space-between;color:#059669;font-weight:600;font-size:11px"><span>ì—°ë§¤ì¶œ</span><b>ì•½ '+fmtRevKr(c.annualRevenue)+'ì›</b></div>'
    +(c.forSale?'<div style="display:flex;justify-content:space-between;color:#7c3aed;font-weight:600;font-size:11px;margin-top:2px"><span>ì¸ìˆ˜ê°€</span><b>ì•½ '+fmtRevKr(c.estimatedAcquisitionPrice)+'ì›</b></div>':'')
    +'</div></div>';
}
function renderReportMap(r,clinics,spots){
  if(reportMap){reportMap.remove();reportMap=null}
  var el=document.getElementById('report-map');if(!el||typeof L==='undefined')return;
  reportMap=L.map('report-map',{scrollWheelZoom:true,zoomControl:true}).setView([r.lat,r.lng],15);
  L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',{attribution:'&copy; OpenStreetMap',maxZoom:18}).addTo(reportMap);
  /* legend */
  var legend=L.control({position:'bottomright'});
  legend.onAdd=function(){var d=L.DomUtil.create('div','map-legend');L.DomEvent.disableClickPropagation(d);L.DomEvent.disableScrollPropagation(d);
    d.innerHTML='<h4 onclick="this.parentElement.classList.toggle(\'collapsed\')"><span>ë²”ë¡€</span><span class="leg-arrow">â–¼</span></h4><div class="leg-body"><div class="leg-section"><div class="leg-title">ë§ˆì»¤</div><div class="leg-row"><div class="leg-dot" style="background:#3b82f6"></div>ë¶„ì„ ì¤‘ì‹¬</div><div class="leg-row"><div class="leg-dot" style="background:#ef4444"></div>ì˜ì—…ì¤‘ ì¹˜ê³¼</div><div class="leg-row"><div class="leg-dot" style="background:#eab308"></div>íœ´ì—… ì¹˜ê³¼</div><div class="leg-row"><div class="leg-dot" style="background:#9ca3af"></div>íì—… ì¹˜ê³¼</div><div class="leg-row"><div class="leg-dot" style="background:linear-gradient(135deg,#f59e0b,#d97706)"></div>ì¶”ì²œ ê°œì› ìœ„ì¹˜</div></div></div>';
    return d};legend.addTo(reportMap);
  /* center */
  L.marker([r.lat,r.lng],{icon:L.divIcon({className:'',html:'<div style="background:#3b82f6;color:white;width:44px;height:44px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:22px;border:3px solid white;box-shadow:0 2px 12px rgba(59,130,246,.5)">ğŸ“</div>',iconSize:[44,44],iconAnchor:[22,22]})}).addTo(reportMap).bindPopup('<div style="font-family:Pretendard Variable,sans-serif;min-width:140px"><b style="font-size:14px">'+r.dong+'</b><br><span style="font-size:12px;color:#3b82f6;font-weight:bold">ì¢…í•© '+r.scores.total+'ì  Â· '+r.grade+'ë“±ê¸‰</span></div>');
  /* clinics */
  clinics.forEach(function(c){L.marker([c.lat,c.lng],{icon:L.divIcon({className:'',html:'<div style="background:'+(c.status==='ì˜ì—…ì¤‘'?'#ef4444':c.status==='íœ´ì—…'?'#eab308':'#9ca3af')+';color:white;width:28px;height:28px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:14px;border:2px solid white;box-shadow:0 2px 6px rgba(0,0,0,.25)">ğŸ¦·</div>',iconSize:[28,28],iconAnchor:[14,14]})}).addTo(reportMap).bindPopup(buildClinicPopup(c),{maxWidth:300})});
  /* recommended */
  spots.forEach(function(s){L.marker([s.lat,s.lng],{icon:L.divIcon({className:'',html:'<div style="position:relative"><div style="position:absolute;inset:-6px;background:rgba(245,158,11,.2);border-radius:50%;animation:marker-pulse 2s infinite"></div><div style="position:relative;background:linear-gradient(135deg,#f59e0b,#d97706);color:white;width:36px;height:36px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:17px;border:3px solid white;box-shadow:0 2px 10px rgba(245,158,11,.5)">â­</div></div>',iconSize:[36,36],iconAnchor:[18,18]})}).addTo(reportMap).bindPopup('<div style="font-family:Pretendard Variable,sans-serif;min-width:200px"><div style="background:#fef3c7;color:#92400e;padding:2px 8px;border-radius:4px;display:inline-block;font-size:10px;font-weight:bold">ğŸ† ì¶”ì²œ</div><div style="font-size:14px;font-weight:bold;margin-top:4px">'+s.label+'</div><div style="font-size:22px;font-weight:bold;color:#3b82f6;margin:4px 0">'+s.score+'ì  <span style="font-size:11px;background:#dbeafe;color:#2563eb;padding:1px 5px;border-radius:3px">'+s.grade+'ë“±ê¸‰</span></div><div style="font-size:11px;color:#4b5563">'+s.reasons.map(function(x){return '<div>âœ… '+x+'</div>'}).join('')+'</div></div>')});
  /* fit */
  var pts=[[r.lat,r.lng]].concat(clinics.map(function(c){return[c.lat,c.lng]})).concat(spots.map(function(s){return[s.lat,s.lng]}));
  if(pts.length>1)reportMap.fitBounds(pts,{padding:[40,40]});
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   RENDER PREMIUM REPORT
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function renderReport(r){
  var tx=genTexts(r);
  var ts=r.scores.total,sl=ts>=80?'ë§¤ìš° ìœ ë§':ts>=70?'ì¶”ì²œ':ts>=60?'ì¡°ê±´ë¶€ ì¶”ì²œ':'ì£¼ì˜ í•„ìš”';
  var verdictIcon=ts>=80?'ğŸŸ¢':ts>=70?'ğŸ”µ':ts>=60?'ğŸŸ¡':'ğŸ”´';
  var clinics=generateNearbyClinics(r);
  var spots=generateRecommendedSpots(r);
  var loc=r.sido?r.sido+' '+r.sigungu+' ':'';
  var fullLoc=(function(){var parts=[];if(r.sido)parts.push(r.sido);if(r.sigungu&&r.sigungu!==r.dong)parts.push(r.sigungu);parts.push(r.dong);return parts.join(' ')})();
  var reportId='DM-'+r.dong_code.slice(0,4)+'-'+new Date().getFullYear()+'-'+String(new Date().getMonth()+1).padStart(2,'0');
  var dateStr=new Date().toLocaleDateString('ko-KR',{year:'numeric',month:'long',day:'numeric'});

  /* Investment calc */
  var ti=r.avg_rent_pyeong*r.area_pyeong*10+r.area_pyeong*200+12000+3000;
  var mr=r.avg_rent_pyeong*r.area_pyeong;
  var dp=Math.round(r.population/Math.max(r.dental_count,1)/120),mRev=dp*15*25;
  var mCost=mr+Math.round(r.area_pyeong*5)+800+Math.round(mRev*0.15)+300;
  var mP=mRev-mCost,be=mP>0?Math.ceil(ti/mP):999;

  /* Risk & Opportunity */
  var risks=[],opps=[];
  if(r.scores.competition<60)risks.push({t:'ê²½ìŸ ê³¼ì—´',d:'ë°˜ê²½ 500m ë‚´ ì¹˜ê³¼ '+r.dental_count+'ê°œ â€” ê²½ìŸì´ ì¹˜ì—´í•œ ì§€ì—­ì…ë‹ˆë‹¤',sev:'high'});
  if(r.scores.cost<60)risks.push({t:'ë†’ì€ ì„ëŒ€ë£Œ',d:'í‰ë‹¹ '+r.avg_rent_pyeong+'ë§Œì›ìœ¼ë¡œ ì›” ê³ ì •ë¹„ ë¶€ë‹´ì´ í½ë‹ˆë‹¤',sev:'high'});
  if(r.pop_growth_rate<1)risks.push({t:'ì¸êµ¬ ì •ì²´',d:'ì¸êµ¬ ì¦ê°€ìœ¨ '+r.pop_growth_rate+'%ë¡œ ì„±ì¥ì´ ë‘”í™”ë˜ê³  ìˆìŠµë‹ˆë‹¤',sev:'medium'});
  if(r.age_60_plus_pct>30)risks.push({t:'ê³ ë ¹ ì¸êµ¬ ë¹„ì¤‘',d:'60ì„¸ ì´ìƒ '+r.age_60_plus_pct+'%ë¡œ ì§„ë£Œ ë‹¨ê°€ê°€ ë‚®ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤',sev:'low'});
  if(risks.length===0)risks.push({t:'ì „ë°˜ì  ë¦¬ìŠ¤í¬ ë‚®ìŒ',d:'ì£¼ìš” ìœ„í—˜ ìš”ì¸ì´ ë°œê²¬ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤',sev:'low'});
  if(r.scores.population>=70)opps.push({t:'í’ë¶€í•œ ìˆ˜ìš”',d:'ì¸êµ¬ '+fmt(r.population)+'ëª…ìœ¼ë¡œ ì•ˆì •ì  í™˜ì í™•ë³´ ê°€ëŠ¥'});
  if(r.pop_growth_rate>=3)opps.push({t:'ê¸‰ì„±ì¥ ì§€ì—­',d:'ì¸êµ¬ +'+r.pop_growth_rate+'% ì¦ê°€ë¡œ ì‹ ê·œ ìˆ˜ìš” ì§€ì† ì°½ì¶œ'});
  if(r.age_20_39_pct>=35)opps.push({t:'ì Šì€ ì¸êµ¬ ë°€ì§‘',d:'20~39ì„¸ '+r.age_20_39_pct+'%ë¡œ ì‹¬ë¯¸Â·êµì • ê³ ë‹¨ê°€ ì§„ë£Œ ìˆ˜ìš”'});
  if(r.scores.access>=80)opps.push({t:'ìš°ìˆ˜í•œ ì ‘ê·¼ì„±',d:r.subway_station+' ë„ë³´ '+r.subway_walk_min+'ë¶„, ìœ ë™ì¸êµ¬ '+fmt(r.daily_floating)+'ëª…'});
  if(opps.length===0)opps.push({t:'íŠ¹ë³„í•œ ê¸°íšŒ ìš”ì¸ ì—†ìŒ',d:'ì°¨ë³„í™” ì „ëµì´ ì¤‘ìš”í•©ë‹ˆë‹¤'});

  /* Active clinics for competition section */
  var activeClinics=clinics.filter(function(c){return c.status==='ì˜ì—…ì¤‘'}).sort(function(a,b){return b.annualRevenue-a.annualRevenue}).slice(0,5);

  var h='<div class="max-w-4xl mx-auto px-6 py-8">';

  /* â”€â”€ 00 COVER â”€â”€ */
  h+='<div class="bg-gradient-to-br from-slate-900 via-blue-900 to-slate-800 rounded-3xl p-8 md:p-12 text-white mb-8 fade-in relative overflow-hidden font-bold">';
  h+='<div class="absolute top-0 right-0 w-64 h-64 bg-blue-500/10 rounded-full -translate-y-1/2 translate-x-1/2"></div>';
  h+='<div class="absolute bottom-0 left-0 w-48 h-48 bg-blue-400/10 rounded-full translate-y-1/2 -translate-x-1/2"></div>';
  h+='<div class="relative">';
  h+='<div class="flex items-center justify-between mb-8"><div class="flex items-center gap-3"><div class="w-9 h-9 bg-blue-500 rounded-lg flex items-center justify-center"><span class="text-white font-bold text-sm">D</span></div><span class="font-bold text-white text-lg">ë´íƒˆë§µAI <span class="text-base font-semibold text-yellow-300">ì¹˜ê³¼ê°œì› ì…ì§€ë¶„ì„</span></span></div><div class="text-right"><p class="text-yellow-300 text-xs">'+dateStr+'</p><span class="inline-block mt-1 text-[10px] bg-white/10 text-yellow-200 px-2 py-0.5 rounded-full">CONFIDENTIAL</span></div></div>';
  h+='<h1 class="text-3xl md:text-4xl font-bold leading-tight">'+r.dong+'<br><span class="text-yellow-300 text-xl md:text-2xl font-medium">ì¹˜ê³¼ ê°œì› AI ì…ì§€ë¶„ì„ ë° ì¶”ì²œ ë¦¬í¬íŠ¸</span></h1>';
  h+='<p class="mt-3 text-yellow-200/80 text-sm">'+fullLoc+' ì§€ì—­ì˜ ì¸êµ¬, ê²½ìŸ, ë¹„ìš©, ì ‘ê·¼ì„±, ì„±ì¥ì„±ì„ ì¢…í•© ë¶„ì„í•œ AI ì˜ì‚¬ê²°ì • ë³´ê³ ì„œ</p>';
  /* â”€â”€ ì˜ë¢°ì ì •ë³´ â”€â”€ */
  var _cp=new URLSearchParams(window.location.search);
  var cName=_cp.get('cname')||'',cPhone=_cp.get('cphone')||'',cEmail=_cp.get('cemail')||'',cInfo=_cp.get('cinfo')||'';
  h+='<div class="mt-5 bg-white/10 backdrop-blur rounded-xl p-4 grid grid-cols-2 md:grid-cols-4 gap-3 text-sm">';
  h+='<div><p class="text-yellow-300/70 text-[10px] mb-0.5">ì˜ë¢°ìëª…</p><p class="text-white font-medium min-h-[20px]">'+(cName||'&nbsp;')+'</p></div>';
  h+='<div><p class="text-yellow-300/70 text-[10px] mb-0.5">íœ´ëŒ€í° ë²ˆí˜¸</p><p class="text-white font-medium min-h-[20px]">'+(cPhone||'&nbsp;')+'</p></div>';
  h+='<div><p class="text-yellow-300/70 text-[10px] mb-0.5">ì´ë©”ì¼ ì£¼ì†Œ</p><p class="text-white font-medium min-h-[20px]">'+(cEmail||'&nbsp;')+'</p></div>';
  h+='<div><p class="text-yellow-300/70 text-[10px] mb-0.5">ì˜ë¢°ì ì •ë³´</p><p class="text-white font-medium min-h-[20px]">'+(cInfo||'&nbsp;')+'</p></div>';
  h+='</div>';
  h+='<div class="mt-8 flex flex-wrap items-center gap-4"><div class="bg-white/10 backdrop-blur rounded-2xl px-6 py-4 text-center"><p class="text-4xl font-bold">'+ts+'</p><p class="text-yellow-300 text-xs mt-1">ì¢…í•© ì ìˆ˜</p></div><div class="bg-white/10 backdrop-blur rounded-2xl px-6 py-4 text-center"><p class="text-3xl font-bold '+({A:'text-blue-400',B:'text-green-400',C:'text-yellow-400',D:'text-orange-400'}[r.grade]||'text-red-400')+'">'+r.grade+'</p><p class="text-yellow-300 text-xs mt-1">ë“±ê¸‰</p></div><div class="bg-white/10 backdrop-blur rounded-2xl px-6 py-4 text-center"><p class="text-lg font-bold">'+verdictIcon+' '+sl+'</p><p class="text-yellow-300 text-xs mt-1">íŒì •</p></div></div>';
  h+='<div class="mt-5 bg-white/5 backdrop-blur rounded-xl p-4 text-[10px] space-y-2.5">';
  h+='<div class="flex flex-wrap items-center gap-3"><span class="text-yellow-300/70 w-16 shrink-0">ì¢…í•© ì ìˆ˜:</span><span class="text-yellow-100">ì¸êµ¬/ìˆ˜ìš”(25%) + ê²½ìŸ í™˜ê²½(25%) + ë¹„ìš© íš¨ìœ¨(20%) + ì ‘ê·¼ì„±(15%) + ì„±ì¥ì„±(15%)ì˜ ê°€ì¤‘ í‰ê·  (0~100ì )</span></div>';
  h+='<div class="flex flex-wrap items-center gap-3"><span class="text-yellow-300/70 w-16 shrink-0">ë“±ê¸‰:</span><span class="inline-flex items-center gap-1 bg-white/10 rounded-full px-2.5 py-1'+(r.grade==='A'?' ring-1 ring-white/40':'')+'"><span class="text-blue-400 font-bold">A</span> <span class="text-yellow-300/70">80+</span></span><span class="inline-flex items-center gap-1 bg-white/10 rounded-full px-2.5 py-1'+(r.grade==='B'?' ring-1 ring-white/40':'')+'"><span class="text-green-400 font-bold">B</span> <span class="text-yellow-300/70">70-79</span></span><span class="inline-flex items-center gap-1 bg-white/10 rounded-full px-2.5 py-1'+(r.grade==='C'?' ring-1 ring-white/40':'')+'"><span class="text-yellow-400 font-bold">C</span> <span class="text-yellow-300/70">60-69</span></span><span class="inline-flex items-center gap-1 bg-white/10 rounded-full px-2.5 py-1'+(r.grade==='D'?' ring-1 ring-white/40':'')+'"><span class="text-orange-400 font-bold">D</span> <span class="text-yellow-300/70">60 ë¯¸ë§Œ</span></span></div>';
  h+='<div class="flex flex-wrap items-center gap-3"><span class="text-yellow-300/70 w-16 shrink-0">íŒì •:</span><span class="inline-flex items-center gap-1 bg-white/10 rounded-full px-2.5 py-1'+(ts>=80?' ring-1 ring-white/40':'')+'">ğŸŸ¢ ë§¤ìš° ìœ ë§ <span class="text-yellow-300/70">80+</span></span><span class="inline-flex items-center gap-1 bg-white/10 rounded-full px-2.5 py-1'+(ts>=70&&ts<80?' ring-1 ring-white/40':'')+'">ğŸ”µ ì¶”ì²œ <span class="text-yellow-300/70">70-79</span></span><span class="inline-flex items-center gap-1 bg-white/10 rounded-full px-2.5 py-1'+(ts>=60&&ts<70?' ring-1 ring-white/40':'')+'">ğŸŸ¡ ì¡°ê±´ë¶€ ì¶”ì²œ <span class="text-yellow-300/70">60-69</span></span><span class="inline-flex items-center gap-1 bg-white/10 rounded-full px-2.5 py-1'+(ts<60?' ring-1 ring-white/40':'')+'">ğŸ”´ ì£¼ì˜ í•„ìš” <span class="text-yellow-300/70">60 ë¯¸ë§Œ</span></span></div>';
  h+='</div>';
  h+='</div></div>';

  /* â”€â”€ 01 EXECUTIVE SUMMARY (~300 words) â”€â”€ */
  var popLabel=r.scores.population>=80?'ë§¤ìš° í’ë¶€í•œ':r.scores.population>=60?'ì–‘í˜¸í•œ':'ë‹¤ì†Œ ë¶€ì¡±í•œ';
  var compLabel=r.scores.competition>=70?'ë‚®ì€ ê²½ìŸ ë°€ë„ë¡œ ìœ ë¦¬í•œ':r.scores.competition>=50?'í‰ê· ì ì¸ ê²½ìŸ ìˆ˜ì¤€ì˜':'ë†’ì€ ê²½ìŸ ë°€ë„ë¡œ ì¹˜ì—´í•œ';
  var costLabel=r.scores.cost>=70?'í•©ë¦¬ì ì¸ ë¹„ìš© êµ¬ì¡°ë¥¼ ê°–ì¶˜':r.scores.cost>=50?'í‰ê· ì ì¸ ë¹„ìš© ë¶€ë‹´ì˜':'ë†’ì€ ê³ ì •ë¹„ê°€ ì˜ˆìƒë˜ëŠ”';
  var accessLabel=r.scores.access>=80?'ë§¤ìš° ìš°ìˆ˜í•œ':r.scores.access>=60?'ì–‘í˜¸í•œ':'ê°œì„ ì´ í•„ìš”í•œ';
  var growthLabel=r.pop_growth_rate>=3?'ë¹ ë¥´ê²Œ ì„±ì¥í•˜ëŠ”':r.pop_growth_rate>=1?'ì•ˆì •ì ì¸ ì„±ì¥ì„¸ì˜':'ì„±ì¥ì´ ì •ì²´ëœ';

  var execSummary='';
  /* Para 1: ì¢…í•© íŒì • */
  execSummary+='<b class="text-base">ì¢…í•© íŒì •: '+sl+' ('+ts+'ì , '+r.grade+'ë“±ê¸‰)</b><br><br>';
  execSummary+=fullLoc+' ì§€ì—­ì— ëŒ€í•œ ì¹˜ê³¼ ê°œì› ì…ì§€ ì í•©ì„±ì„ ì¸êµ¬/ìˆ˜ìš”, ê²½ìŸ í™˜ê²½, ë¹„ìš© íš¨ìœ¨, ì ‘ê·¼ì„±, ì„±ì¥ì„±ì˜ 5ê°œ í•µì‹¬ ì¶•ì„ ê¸°ë°˜ìœ¼ë¡œ ì¢…í•© ë¶„ì„í•œ ê²°ê³¼, ';
  execSummary+=ts>=80?'í•´ë‹¹ ì§€ì—­ì€ <b>ì¹˜ê³¼ ê°œì›ì— ë§¤ìš° ìœ ë§í•œ ì…ì§€</b>ë¡œ í‰ê°€ë©ë‹ˆë‹¤. ':'';
  execSummary+=ts>=70&&ts<80?'í•´ë‹¹ ì§€ì—­ì€ <b>ê°œì›ì— ì í•©í•œ ì…ì§€</b>ë¡œ í‰ê°€ë©ë‹ˆë‹¤. ':'';
  execSummary+=ts>=60&&ts<70?'í•´ë‹¹ ì§€ì—­ì€ <b>ì¡°ê±´ë¶€ë¡œ ê°œì›ì´ ê°€ëŠ¥í•œ ì…ì§€</b>ë¡œ í‰ê°€ë©ë‹ˆë‹¤. ':'';
  execSummary+=ts<60?'í•´ë‹¹ ì§€ì—­ì€ <b>ê°œì›ì— ì‹ ì¤‘í•œ ì ‘ê·¼ì´ í•„ìš”í•œ ì…ì§€</b>ë¡œ í‰ê°€ë©ë‹ˆë‹¤. ':'';
  execSummary+='5ì¶• ë¶„ì„ ê²°ê³¼, ì¸êµ¬/ìˆ˜ìš” '+r.scores.population+'ì , ê²½ìŸ í™˜ê²½ '+r.scores.competition+'ì , ë¹„ìš© íš¨ìœ¨ '+r.scores.cost+'ì , ì ‘ê·¼ì„± '+r.scores.access+'ì , ì„±ì¥ì„± '+r.scores.growth+'ì ìœ¼ë¡œ ì‚°ì¶œë˜ì—ˆìŠµë‹ˆë‹¤.';

  /* Para 2: ì¸êµ¬Â·ìˆ˜ìš”Â·ê²½ìŸ */
  execSummary+='<br><br><b>ì¸êµ¬ ë° ê²½ìŸ ë¶„ì„.</b> ë°˜ê²½ 1km ë‚´ ê±°ì£¼ì¸êµ¬ '+fmt(r.population)+'ëª…, ì¼ ìœ ë™ì¸êµ¬ '+fmt(r.daily_floating)+'ëª…ìœ¼ë¡œ '+popLabel+' ìˆ˜ìš” ê¸°ë°˜ì„ ë³´ìœ í•˜ê³  ìˆìŠµë‹ˆë‹¤. ';
  execSummary+='íŠ¹íˆ 20~39ì„¸ í•µì‹¬ íƒ€ê²Ÿ ì¸êµ¬ ë¹„ì¤‘ì´ '+r.age_20_39_pct+'%ë¡œ, '+(r.age_20_39_pct>=35?'ì‹¬ë¯¸Â·êµì • ë“± ê³ ë‹¨ê°€ ì§„ë£Œ ìˆ˜ìš”ê°€ ë†’ì„ ê²ƒìœ¼ë¡œ ì „ë§ë©ë‹ˆë‹¤. ':'í‰ê·  ìˆ˜ì¤€ì˜ ì‹¬ë¯¸Â·êµì • ìˆ˜ìš”ê°€ ì˜ˆìƒë©ë‹ˆë‹¤. ');
  execSummary+='ë°˜ê²½ 500m ë‚´ ê¸°ì¡´ ì¹˜ê³¼ '+r.dental_count+'ê°œê°€ ìš´ì˜ ì¤‘ì´ë©°, ì¸êµ¬ë‹¹ ì¹˜ê³¼ ë¹„ìœ¨ì€ 1:'+fmt(r.pop_per_clinic)+'ìœ¼ë¡œ '+compLabel+' í™˜ê²½ì…ë‹ˆë‹¤. ';
  execSummary+='ì¸êµ¬ ì¦ê°€ìœ¨ '+(r.pop_growth_rate>0?'+':'')+r.pop_growth_rate+'%ë¡œ '+growthLabel+' ì§€ì—­ì´ë©°, ìƒê¶Œ ë“±ê¸‰ì€ '+r.commercial_grade+'ë“±ê¸‰ì…ë‹ˆë‹¤.';

  /* Para 3: ë¹„ìš©Â·ì ‘ê·¼ì„± */
  execSummary+='<br><br><b>ë¹„ìš© ë° ì ‘ê·¼ì„±.</b> í‰ë‹¹ ì„ëŒ€ë£Œ '+r.avg_rent_pyeong+'ë§Œì›('+r.area_pyeong+'í‰ ê¸°ì¤€ ì›” '+fmt(mr)+'ë§Œì›)ìœ¼ë¡œ '+costLabel+' ì§€ì—­ì…ë‹ˆë‹¤. ';
  execSummary+='ìµœê·¼ì ‘ ì—­ '+r.subway_station+'('+r.subway_line+') ë„ë³´ '+r.subway_walk_min+'ë¶„, ë°˜ê²½ 500m ë‚´ ë²„ìŠ¤ì •ë¥˜ì¥ '+r.bus_stops_500m+'ê°œë¡œ '+accessLabel+' ëŒ€ì¤‘êµí†µ ì ‘ê·¼ì„±ì„ ê°–ì¶”ê³  ìˆìŠµë‹ˆë‹¤.';

  /* Para 4: íˆ¬ìÂ·ìˆ˜ìµ */
  execSummary+='<br><br><b>íˆ¬ì ë° ìˆ˜ìµ ì „ë§.</b> ë³´ì¦ê¸ˆ, ì¸í…Œë¦¬ì–´, ì˜ë£Œì¥ë¹„, ìš´ì˜ìê¸ˆì„ í¬í•¨í•œ ì´ˆê¸° íˆ¬ìê¸ˆì€ ì•½ <b>'+(ti/10000).toFixed(1)+'ì–µì›</b>ìœ¼ë¡œ ì¶”ì‚°ë©ë‹ˆë‹¤. ';
  execSummary+='ì¼ ì˜ˆìƒ í™˜ì ìˆ˜ '+dp+'ëª…, ê°ë‹¨ê°€ 15ë§Œì› ê¸°ì¤€ <b>ì›” ë§¤ì¶œ '+fmt(mRev)+'ë§Œì›</b>, ì„ëŒ€ë£ŒÂ·ì¸ê±´ë¹„Â·ì¬ë£Œë¹„ ë“± ê³ ì •ë¹„ ì°¨ê° í›„ <b>ì›” ìˆœì´ìµ '+(mP>0?'+':'')+fmt(mP)+'ë§Œì›</b>ì´ ê¸°ëŒ€ë©ë‹ˆë‹¤. ';
  execSummary+=mP>0?'ê¸°ë³¸ ì‹œë‚˜ë¦¬ì˜¤ ê¸°ì¤€ <b>'+be+'ê°œì›” ë‚´ ì†ìµë¶„ê¸° ë‹¬ì„±</b>ì´ ì „ë§ë˜ë©°, ë³´ìˆ˜ì  ì‹œë‚˜ë¦¬ì˜¤ì—ì„œë„ ì•½ '+Math.round(be*1.4)+'ê°œì›” ë‚´ íšŒìˆ˜ê°€ ê°€ëŠ¥í•  ê²ƒìœ¼ë¡œ ë¶„ì„ë©ë‹ˆë‹¤.':'í˜„ ì¡°ê±´ì—ì„œëŠ” ì†ìµë¶„ê¸° ë‹¬ì„±ì— ìƒë‹¹í•œ ê¸°ê°„ì´ ì†Œìš”ë  ìˆ˜ ìˆìœ¼ë¯€ë¡œ, ë¹„ìš© ì ˆê° ë˜ëŠ” ë§¤ì¶œ ê·¹ëŒ€í™” ì „ëµì´ í•„ìš”í•©ë‹ˆë‹¤.';

  /* Para 5: ê²°ë¡  */
  execSummary+='<br><br><b>ê²°ë¡ .</b> ';
  execSummary+=ts>=80?'ì¢…í•©ì ìœ¼ë¡œ '+r.dong+' ì§€ì—­ì€ ìˆ˜ìš”, ê²½ìŸ, ë¹„ìš©, ì ‘ê·¼ì„±, ì„±ì¥ì„± ë“± ëª¨ë“  ì¸¡ë©´ì—ì„œ ìš°ìˆ˜í•œ ì¡°ê±´ì„ ê°–ì¶”ê³  ìˆì–´ <b>ì ê·¹ì ì¸ ê°œì›ì„ ê¶Œì¥</b>í•©ë‹ˆë‹¤. AIê°€ ì¶”ì²œí•˜ëŠ” ìµœì  ê°œì› ìœ„ì¹˜ë¥¼ ì¤‘ì‹¬ìœ¼ë¡œ ì„ëŒ€ ë¬¼ê±´ íƒìƒ‰ê³¼ í˜„ì¥ ì‹¤ì‚¬ë¥¼ ì§„í–‰í•˜ì‹œê¸° ë°”ëë‹ˆë‹¤.':'';
  execSummary+=ts>=70&&ts<80?'ì¢…í•©ì ìœ¼ë¡œ '+r.dong+' ì§€ì—­ì€ ì–‘í˜¸í•œ ì…ì§€ ì¡°ê±´ì„ ê°–ì¶”ê³  ìˆìœ¼ë©°, ê²½ìŸ í˜„í™©ì„ ê³ ë ¤í•œ <b>ì°¨ë³„í™” ì§„ë£Œ ì „ëµê³¼ í•¨ê»˜ ê°œì›ì„ ì¶”ì²œ</b>í•©ë‹ˆë‹¤. ì•„ë˜ ìƒì„¸ ë¶„ì„ê³¼ ì¶”ì²œ ìœ„ì¹˜ë¥¼ ì°¸ê³ í•˜ì—¬ ì˜ì‚¬ê²°ì •ì— í™œìš©í•˜ì‹œê¸° ë°”ëë‹ˆë‹¤.':'';
  execSummary+=ts>=60&&ts<70?'ì¢…í•©ì ìœ¼ë¡œ '+r.dong+' ì§€ì—­ì€ ì¼ë¶€ ë¦¬ìŠ¤í¬ ìš”ì¸ì´ ì¡´ì¬í•˜ë‚˜, ì ì ˆí•œ ì „ëµ ìˆ˜ë¦½ ì‹œ ìˆ˜ìµ ì°½ì¶œì´ ê°€ëŠ¥í•©ë‹ˆë‹¤. <b>ì „ë¬¸ê°€ ìƒë‹´ê³¼ í˜„ì¥ ì‹¤ì‚¬ë¥¼ ë³‘í–‰</b>í•˜ì—¬ ìµœì¢… ê²°ì •í•˜ì‹œê¸°ë¥¼ ê¶Œì¥í•©ë‹ˆë‹¤.':'';
  execSummary+=ts<60?'ì¢…í•©ì ìœ¼ë¡œ '+r.dong+' ì§€ì—­ì€ ë‹¤ìˆ˜ì˜ ë¦¬ìŠ¤í¬ ìš”ì¸ì´ í™•ì¸ë˜ì—ˆìŠµë‹ˆë‹¤. <b>ê°œì› ì „ ë°˜ë“œì‹œ ì „ë¬¸ê°€ ìƒë‹´ê³¼ ì‹¬ì¸µ ì‹œì¥ ì¡°ì‚¬</b>ë¥¼ ì‹¤ì‹œí•˜ê³ , ëŒ€ì•ˆ ì…ì§€ì™€ì˜ ë¹„êµ ë¶„ì„ì„ í†µí•´ ìµœì¢… ê²°ì •í•˜ì‹œê¸°ë¥¼ ê°•ë ¥íˆ ê¶Œì¥í•©ë‹ˆë‹¤.':'';

  h+='<section class="bg-white rounded-2xl border-2 border-blue-300 p-6 md:p-8 shadow-sm mb-6 fade-in fade-in-1">';
  h+='<div class="flex items-center gap-3 mb-4"><span class="text-xs font-bold text-white bg-blue-600 w-7 h-7 rounded-lg flex items-center justify-center">01</span><h2 class="text-lg font-bold">Executive Summary</h2><span class="text-xs text-gray-400 ml-auto">'+fullLoc+' Â· '+dateStr+'</span></div>';
  h+='<div class="bg-gradient-to-r '+(ts>=70?'from-blue-50 to-cyan-50 border-blue-200':'from-yellow-50 to-orange-50 border-yellow-200')+' border rounded-xl p-6">';
  h+='<div class="flex items-start gap-4"><span class="text-4xl shrink-0 mt-1">'+verdictIcon+'</span><div class="text-sm leading-[1.8] text-gray-700">'+execSummary+'</div></div></div></section>';

  /* â”€â”€ 02 RADAR CHART + SCORES â”€â”€ */
  h+='<section class="bg-white rounded-2xl border-2 border-indigo-300 p-6 md:p-8 shadow-sm mb-6 fade-in fade-in-2">';
  h+='<div class="flex items-center gap-3 mb-6"><span class="text-xs font-bold text-white bg-blue-600 w-7 h-7 rounded-lg flex items-center justify-center">02</span><h2 class="text-lg font-bold">ì¢…í•© ë¶„ì„ ì ìˆ˜</h2></div>';
  h+='<div class="grid md:grid-cols-2 gap-8 items-center"><div class="text-center">'+drawRadarChart(r.scores)+'</div>';
  h+='<div><div class="text-center mb-4"><p class="text-6xl font-bold '+getScoreColor(ts)+'">'+ts+'</p><p class="text-sm text-gray-500 mt-1"><span class="inline-block px-3 py-1 rounded-full text-sm font-bold '+getGradeColor(r.grade)+'">'+r.grade+'ë“±ê¸‰</span> Â· '+sl+'</p></div>';
  h+='<div class="space-y-3 mt-6">';
  [{l:'ì¸êµ¬/ìˆ˜ìš”',s:r.scores.population,i:'ğŸ‘¥'},{l:'ê²½ìŸ í™˜ê²½',s:r.scores.competition,i:'ğŸ¥'},{l:'ë¹„ìš© íš¨ìœ¨',s:r.scores.cost,i:'ğŸ’°'},{l:'ì ‘ê·¼ì„±',s:r.scores.access,i:'ğŸš‡'},{l:'ì„±ì¥ì„±',s:r.scores.growth,i:'ğŸ“ˆ'}].forEach(function(a){
    h+='<div class="flex items-center gap-3"><span class="text-lg w-6">'+a.i+'</span><span class="text-sm text-gray-600 w-16">'+a.l+'</span><div class="flex-1 h-3 bg-gray-100 rounded-full overflow-hidden"><div class="h-full rounded-full transition-all '+getScoreBarColor(a.s)+'" style="width:'+a.s+'%"></div></div><span class="text-sm font-bold w-10 text-right '+getScoreColor(a.s)+'">'+a.s+'</span></div>';
  });
  h+='</div></div></div></section>';

  /* â”€â”€ 03 MAP â”€â”€ */
  h+='<section class="bg-white rounded-2xl border-2 border-teal-300 shadow-sm mb-6 overflow-hidden fade-in fade-in-3">';
  h+='<div class="p-6 md:p-8 pb-4"><div class="flex items-center gap-3 mb-2"><span class="text-xs font-bold text-white bg-blue-600 w-7 h-7 rounded-lg flex items-center justify-center">03</span><h2 class="text-lg font-bold">ì…ì§€ ë¶„ì„ ì§€ë„</h2></div>';
  h+='<p class="text-sm text-gray-500 mb-4">ë¶„ì„ ì§€ì—­ ì¤‘ì‹¬ ë°˜ê²½ 500m ë‚´ ì¹˜ê³¼ '+clinics.length+'ê°œ, AI ì¶”ì²œ ê°œì› ìœ„ì¹˜ '+spots.length+'ê³³</p></div>';
  h+='<div id="report-map" style="height:500px;z-index:0"></div>';
  h+='<div class="px-6 py-3 text-[11px] text-gray-400 border-t border-gray-100 bg-gray-50">ë§ˆì»¤ë¥¼ í´ë¦­í•˜ë©´ ìƒì„¸ ì •ë³´ë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤ Â· ìš°ì¸¡ í•˜ë‹¨ ë²”ë¡€ ì°¸ì¡°</div></section>';

  /* â”€â”€ 04 RECOMMENDED SPOTS â”€â”€ */
  h+='<section class="mb-6 fade-in fade-in-4"><div class="grid md:grid-cols-2 gap-4">';
  spots.forEach(function(s){
    h+='<div class="bg-gradient-to-br from-amber-50 to-orange-50 border-2 border-amber-200 rounded-2xl p-6">';
    h+='<div class="flex items-center gap-2 mb-3"><span class="text-lg">â­</span><span class="text-xs font-bold text-amber-800 bg-amber-200 px-2.5 py-0.5 rounded-full">ë´íƒˆë§µ AI ì¶”ì²œ</span><span class="text-xs font-bold text-blue-700 bg-blue-100 px-2 py-0.5 rounded-full ml-auto">'+s.grade+'ë“±ê¸‰</span></div>';
    h+='<h3 class="font-bold text-base">'+s.label+'</h3>';
    h+='<p class="text-3xl font-bold text-blue-600 mt-1">'+s.score+'<span class="text-sm text-gray-400 font-medium">ì </span></p>';
    h+='<ul class="mt-3 space-y-1.5">'+s.reasons.map(function(x){return '<li class="text-sm text-gray-700 flex items-start gap-1.5"><span class="text-green-500 mt-0.5 shrink-0">âœ“</span>'+x+'</li>'}).join('')+'</ul>';
    h+='<div class="mt-3 pt-3 border-t border-amber-200 flex gap-4 text-xs text-gray-500"><span>ì„ëŒ€ë£Œ '+s.rent+'ë§Œ/í‰</span><span>ì£¼ë³€ì¸êµ¬ '+fmt(s.estPop)+'ëª…</span></div></div>';
  });
  h+='</div></section>';

  /* â”€â”€ 05 5-AXIS DETAIL â”€â”€ */
  h+='<section class="bg-white rounded-2xl border-2 border-violet-300 p-6 md:p-8 shadow-sm mb-6 fade-in fade-in-5">';
  h+='<div class="flex items-center gap-3 mb-6"><span class="text-xs font-bold text-white bg-blue-600 w-7 h-7 rounded-lg flex items-center justify-center">04</span><h2 class="text-lg font-bold">5ì¶• ìƒì„¸ ë¶„ì„</h2></div>';
  h+='<div class="space-y-4">';
  [{i:'ğŸ‘¥',l:'ì¸êµ¬/ìˆ˜ìš”',s:r.scores.population,t:tx.popText},{i:'ğŸ¥',l:'ê²½ìŸ í™˜ê²½',s:r.scores.competition,t:tx.compText},{i:'ğŸ’°',l:'ë¹„ìš© íš¨ìœ¨',s:r.scores.cost,t:tx.costText},{i:'ğŸš‡',l:'ì ‘ê·¼ì„±',s:r.scores.access,t:tx.accessText},{i:'ğŸ“ˆ',l:'ì„±ì¥ì„±',s:r.scores.growth,t:tx.growthText}].forEach(function(a){
    h+='<div class="bg-gray-50 rounded-xl p-5"><div class="flex items-center justify-between mb-2"><div class="flex items-center gap-2"><span class="text-xl">'+a.i+'</span><h3 class="font-bold text-sm">'+a.l+'</h3></div><span class="text-lg font-bold '+getScoreColor(a.s)+'">'+a.s+'ì </span></div>';
    h+='<div class="w-full h-2 bg-gray-200 rounded-full overflow-hidden mb-3"><div class="h-full rounded-full '+getScoreBarColor(a.s)+'" style="width:'+a.s+'%"></div></div>';
    h+='<p class="text-sm text-gray-600 leading-relaxed">'+a.t+'</p></div>';
  });
  h+='</div></section>';

  /* â”€â”€ 06 DEMOGRAPHICS â”€â”€ */
  h+='<section class="bg-white rounded-2xl border-2 border-cyan-300 p-6 md:p-8 shadow-sm mb-6 fade-in fade-in-6">';
  h+='<div class="flex items-center gap-3 mb-6"><span class="text-xs font-bold text-white bg-blue-600 w-7 h-7 rounded-lg flex items-center justify-center">05</span><h2 class="text-lg font-bold">ì¸êµ¬ í†µê³„ ë¶„ì„</h2></div>';
  h+='<div class="grid md:grid-cols-2 gap-8"><div>';
  h+='<div class="grid grid-cols-2 gap-4 mb-6">';
  h+='<div class="bg-blue-50 rounded-xl p-4 text-center"><p class="text-3xl font-bold text-blue-600">'+fmt(r.population)+'</p><p class="text-xs text-gray-500 mt-1">ê±°ì£¼ì¸êµ¬ (ëª…)</p></div>';
  h+='<div class="bg-green-50 rounded-xl p-4 text-center"><p class="text-3xl font-bold text-green-600">'+fmt(r.daily_floating)+'</p><p class="text-xs text-gray-500 mt-1">ì¼ ìœ ë™ì¸êµ¬ (ëª…)</p></div>';
  h+='</div>';
  h+='<div class="space-y-4">';
  [{l:'20~39ì„¸ (í•µì‹¬ íƒ€ê²Ÿ)',v:r.age_20_39_pct,c:'bg-blue-500'},{l:'40~59ì„¸',v:r.age_40_59_pct,c:'bg-green-500'},{l:'60ì„¸ ì´ìƒ',v:r.age_60_plus_pct,c:'bg-gray-400'}].forEach(function(g){
    h+='<div><div class="flex justify-between text-sm mb-1"><span class="text-gray-600">'+g.l+'</span><span class="font-bold">'+g.v+'%</span></div><div class="h-3 bg-gray-100 rounded-full overflow-hidden"><div class="h-full rounded-full '+g.c+'" style="width:'+g.v+'%"></div></div></div>';
  });
  h+='</div></div>';
  h+='<div><h3 class="font-bold text-sm mb-4">ì£¼ìš” ì§€í‘œ</h3><div class="space-y-3">';
  [{l:'ì¸êµ¬ë‹¹ ì¹˜ê³¼ ë¹„ìœ¨',v:'1 : '+fmt(r.pop_per_clinic)},{l:'ì¸êµ¬ ì¦ê°€ìœ¨',v:(r.pop_growth_rate>0?'+':'')+r.pop_growth_rate+'%'},{l:'ìƒê¶Œ ë“±ê¸‰',v:r.commercial_grade+'ë“±ê¸‰'},{l:'ìµœê·¼ì ‘ ì—­',v:r.subway_station+' ('+r.subway_line+', '+r.subway_walk_min+'ë¶„)'},{l:'ë²„ìŠ¤ì •ë¥˜ì¥',v:r.bus_stops_500m+'ê°œ (ë°˜ê²½ 500m)'},{l:'í‰ë‹¹ ì„ëŒ€ë£Œ',v:r.avg_rent_pyeong+'ë§Œì›'}].forEach(function(item){
    h+='<div class="flex justify-between py-2 border-b border-gray-50 text-sm"><span class="text-gray-500">'+item.l+'</span><span class="font-medium">'+item.v+'</span></div>';
  });
  h+='</div></div></div></section>';

  /* â”€â”€ 07 COMPETITION LANDSCAPE â”€â”€ */
  h+='<section class="bg-white rounded-2xl border-2 border-rose-300 p-6 md:p-8 shadow-sm mb-6 fade-in fade-in-7">';
  h+='<div class="flex items-center justify-between mb-2"><div class="flex items-center gap-3"><span class="text-xs font-bold text-white bg-blue-600 w-7 h-7 rounded-lg flex items-center justify-center">06</span><h2 class="text-lg font-bold">ê²½ìŸ í˜„í™©</h2></div><div class="flex items-center gap-2 text-[10px]"><span class="text-gray-400">ìƒíƒœ:</span><span class="inline-flex items-center gap-1 bg-green-100 text-green-700 px-2 py-0.5 rounded font-medium">ì˜ì—…ì¤‘</span><span class="inline-flex items-center gap-1 bg-yellow-100 text-yellow-700 px-2 py-0.5 rounded font-medium">íœ´ì—…</span><span class="inline-flex items-center gap-1 bg-gray-200 text-gray-500 px-2 py-0.5 rounded font-medium">íì—…</span><span class="text-gray-300 mx-1">|</span><span class="text-gray-400">ìœ„í˜‘ë„:</span><span class="inline-flex items-center gap-1 bg-red-50 text-red-500 px-2 py-0.5 rounded font-medium" title="ì²´ì–´ 5ëŒ€ ì´ìƒ & 5ë…„ ì´ìƒ ìš´ì˜">ë†’ìŒ<span class="text-red-400 font-normal">(ì²´ì–´5+Â·5ë…„+)</span></span><span class="inline-flex items-center gap-1 bg-amber-50 text-amber-500 px-2 py-0.5 rounded font-medium" title="ì²´ì–´ 3ëŒ€ ì´ìƒ">ë³´í†µ<span class="text-amber-400 font-normal">(ì²´ì–´3+)</span></span><span class="inline-flex items-center gap-1 bg-green-50 text-green-500 px-2 py-0.5 rounded font-medium" title="ì²´ì–´ 3ëŒ€ ë¯¸ë§Œ ì†Œê·œëª¨">ë‚®ìŒ<span class="text-green-400 font-normal">(ì†Œê·œëª¨)</span></span></div></div>';
  var activeCount=clinics.filter(function(c){return c.status==='ì˜ì—…ì¤‘'}).length;
  var closedCount=clinics.filter(function(c){return c.status==='íì—…'}).length;
  var suspCount=clinics.filter(function(c){return c.status==='íœ´ì—…'}).length;
  var forSaleCount=clinics.filter(function(c){return c.forSale}).length;
  h+='<p class="text-sm text-gray-500 mb-6">ë°˜ê²½ 500m ë‚´ ì¹˜ê³¼ '+clinics.length+'ê°œ (ì˜ì—…ì¤‘ '+activeCount+'ê°œ'+(suspCount>0?' Â· íœ´ì—… '+suspCount+'ê°œ':'')+(closedCount>0?' Â· íì—… '+closedCount+'ê°œ':'')+(forSaleCount>0?' Â· ì¸ìˆ˜ê°€ëŠ¥ '+forSaleCount+'ê°œ':'')+')</p>';
  h+='<div class="space-y-4">';
  clinics.sort(function(a,b){var o={ì˜ì—…ì¤‘:0,íœ´ì—…:1,íì—…:2};return(o[a.status]||0)-(o[b.status]||0)||b.annualRevenue-a.annualRevenue});
  clinics.forEach(function(c,i){
    var threatColor=c.competitionThreat==='ë†’ìŒ'?'text-red-500 bg-red-50':c.competitionThreat==='ë³´í†µ'?'text-amber-500 bg-amber-50':'text-green-500 bg-green-50';
    var statusColor=c.status==='ì˜ì—…ì¤‘'?'bg-green-100 text-green-700':c.status==='íœ´ì—…'?'bg-yellow-100 text-yellow-700':'bg-gray-200 text-gray-500';
    var nightLabel=c.nightWeekend===2?'ì•¼ê°„+ì£¼ë§':c.nightWeekend===1?'ì•¼ê°„ì§„ë£Œ':'í•´ë‹¹ì—†ìŒ';
    var nightColor=c.nightWeekend>=1?'bg-indigo-50 text-indigo-600':'bg-gray-100 text-gray-400';
    var cardBorder=c.status==='ì˜ì—…ì¤‘'?'border-green-300':c.status==='íœ´ì—…'?'border-yellow-300':'border-gray-300';
    h+='<div class="bg-gray-50 rounded-xl p-5 border-2 '+cardBorder+'">';
    /* Row 1: Header */
    h+='<div class="flex items-center gap-3 mb-3">';
    h+='<div class="w-10 h-10 '+(c.status==='ì˜ì—…ì¤‘'?'bg-red-100':'bg-gray-200')+' rounded-full flex items-center justify-center text-lg shrink-0">ğŸ¦·</div>';
    h+='<div class="flex-1 min-w-0">';
    h+='<div class="flex items-center gap-2 flex-wrap"><p class="font-bold text-sm">'+c.name+'</p><span class="text-[10px] font-medium '+statusColor+' px-1.5 py-0.5 rounded">'+c.status+'</span>';
    h+='<span class="text-[10px] '+threatColor+' px-1.5 py-0.5 rounded font-medium">ìœ„í˜‘ '+c.competitionThreat+'</span>';
    if(c.forSale)h+='<span class="text-[10px] font-medium bg-purple-100 text-purple-700 px-1.5 py-0.5 rounded">ì¸ìˆ˜ê°€ëŠ¥</span>';
    h+='</div>';
    h+='<p class="text-xs text-gray-500 mt-0.5">'+c.type+' Â· '+c.director+' Â· '+c.estYear+'ë…„ ê°œì—… ('+c.yearsOpen+'ë…„ì°¨)</p>';
    h+='</div></div>';
    /* Row 2: Key metrics grid */
    h+='<div class="grid grid-cols-2 md:grid-cols-4 gap-2 mb-3">';
    h+='<div class="bg-white rounded-lg p-2.5 text-center border border-gray-200"><p class="text-[10px] text-gray-400">ì—°ë§¤ì¶œ</p><p class="text-sm font-bold text-emerald-600">'+fmtRevKr(c.annualRevenue)+'</p></div>';
    h+='<div class="bg-white rounded-lg p-2.5 text-center border border-gray-200"><p class="text-[10px] text-gray-400">ì›”ë§¤ì¶œ</p><p class="text-sm font-bold text-emerald-600">'+fmt(c.monthlyRevenue)+'ë§Œ</p></div>';
    h+='<div class="bg-white rounded-lg p-2.5 text-center border border-gray-200"><p class="text-[10px] text-gray-400">ì¼ í™˜ììˆ˜</p><p class="text-sm font-bold text-blue-600">'+c.dailyPatients+'ëª…</p></div>';
    h+='<div class="bg-white rounded-lg p-2.5 text-center border border-gray-200"><p class="text-[10px] text-gray-400">ë¹„ê¸‰ì—¬ ë¹„ìœ¨</p><p class="text-sm font-bold text-orange-600">'+c.nonCoverageRatio+'%</p></div>';
    h+='</div>';
    /* Row 3: Detail grid */
    h+='<div class="grid grid-cols-3 md:grid-cols-6 gap-2 mb-3 text-center">';
    h+='<div class="bg-white rounded-lg p-2 border border-gray-200"><p class="text-[10px] text-gray-400">ì²´ì–´</p><p class="text-xs font-semibold">'+c.chairs+'ëŒ€</p></div>';
    h+='<div class="bg-white rounded-lg p-2 border border-gray-200"><p class="text-[10px] text-gray-400">ë©´ì </p><p class="text-xs font-semibold">'+c.size+'</p></div>';
    h+='<div class="bg-white rounded-lg p-2 border border-gray-200"><p class="text-[10px] text-gray-400">ì¸µìˆ˜</p><p class="text-xs font-semibold">'+c.floor+'</p></div>';
    h+='<div class="bg-white rounded-lg p-2 border border-gray-200"><p class="text-[10px] text-gray-400">ì˜ì‚¬</p><p class="text-xs font-semibold">'+c.dentistCount+'ëª…</p></div>';
    h+='<div class="bg-white rounded-lg p-2 border border-gray-200"><p class="text-[10px] text-gray-400">ìœ„ìƒì‚¬</p><p class="text-xs font-semibold">'+c.hygienistCount+'ëª…</p></div>';
    h+='<div class="bg-white rounded-lg p-2 border border-gray-200"><p class="text-[10px] text-gray-400">ì´ ì§ì›</p><p class="text-xs font-semibold">'+c.totalStaff+'ëª…</p></div>';
    h+='</div>';
    /* Row 4: Ratings & Online presence */
    h+='<div class="grid grid-cols-2 md:grid-cols-5 gap-2 mb-3 text-center">';
    h+='<div class="bg-white rounded-lg p-2 border border-gray-200"><p class="text-[10px] text-gray-400">ë„¤ì´ë²„ í‰ì </p><p class="text-xs font-semibold text-yellow-500">â˜… '+c.naverRating+'</p></div>';
    h+='<div class="bg-white rounded-lg p-2 border border-gray-200"><p class="text-[10px] text-gray-400">ë¦¬ë·° ìˆ˜</p><p class="text-xs font-semibold">'+fmt(c.naverReviewCount)+'ê±´</p></div>';
    h+='<div class="bg-white rounded-lg p-2 border border-gray-200"><p class="text-[10px] text-gray-400">ë¸”ë¡œê·¸ ë…¸ì¶œ</p><p class="text-xs font-semibold">'+fmt(c.blogExposure)+'ê±´</p></div>';
    h+='<div class="bg-white rounded-lg p-2 border border-gray-200"><p class="text-[10px] text-gray-400">ë³´í—˜ì²­êµ¬</p><p class="text-xs font-semibold">ì›” '+fmt(c.insuranceClaims)+'ê±´</p></div>';
    h+='<div class="bg-white rounded-lg p-2 border border-gray-200"><p class="text-[10px] text-gray-400">ë™ì¢… ê·¼ì ‘</p><p class="text-xs font-semibold">'+c.sameTypeNearby+'ê°œ</p></div>';
    h+='</div>';
    /* Row 5: Tags */
    h+='<div class="flex flex-wrap gap-1.5">';
    c.specialties.forEach(function(sp){h+='<span class="text-[10px] bg-emerald-50 text-emerald-700 px-2 py-0.5 rounded-full">'+sp+'</span>'});
    h+='<span class="text-[10px] '+nightColor+' px-2 py-0.5 rounded-full">'+nightLabel+'</span>';
    h+='<span class="text-[10px] bg-slate-100 text-slate-600 px-2 py-0.5 rounded-full">ê°€ê²©ëŒ€: '+c.priceLevel+'</span>';
    h+='<span class="text-[10px] '+(c.hasParking?'bg-sky-50 text-sky-600':'bg-gray-100 text-gray-400')+' px-2 py-0.5 rounded-full">'+(c.hasParking?'ì£¼ì°¨ ê°€ëŠ¥':'ì£¼ì°¨ ë¶ˆê°€')+'</span>';
    if(c.forSale&&c.estimatedAcquisitionPrice)h+='<span class="text-[10px] bg-purple-50 text-purple-700 px-2 py-0.5 rounded-full font-medium">ì¸ìˆ˜ ì˜ˆìƒê°€ '+fmt(c.estimatedAcquisitionPrice)+'ë§Œ</span>';
    h+='</div>';
    h+='</div>';
  });
  h+='</div></section>';

  /* â”€â”€ 08 INVESTMENT SUMMARY â”€â”€ */
  h+='<section class="bg-white rounded-2xl border-2 border-emerald-300 p-6 md:p-8 shadow-sm mb-6 fade-in fade-in-8">';
  h+='<div class="flex items-center gap-3 mb-6"><span class="text-xs font-bold text-white bg-blue-600 w-7 h-7 rounded-lg flex items-center justify-center">07</span><h2 class="text-lg font-bold">íˆ¬ì ë° ìˆ˜ìµ ë¶„ì„</h2></div>';
  h+='<div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-6">';
  [{l:'ì´ íˆ¬ìê¸ˆ',v:(ti/10000).toFixed(1)+'ì–µ',c:'text-slate-800',bg:'bg-slate-50'},{l:'ì˜ˆìƒ ì›”ë§¤ì¶œ',v:fmt(mRev)+'ë§Œ',c:'text-green-600',bg:'bg-green-50'},{l:'ì›” ìˆœì´ìµ',v:(mP>0?'+':'')+fmt(mP)+'ë§Œ',c:mP>0?'text-blue-600':'text-red-500',bg:mP>0?'bg-blue-50':'bg-red-50'},{l:'ì†ìµë¶„ê¸°',v:be+'ê°œì›”',c:'text-purple-600',bg:'bg-purple-50'}].forEach(function(card){
    h+='<div class="'+card.bg+' rounded-xl p-5 text-center"><p class="text-xs text-gray-500 mb-1">'+card.l+'</p><p class="text-2xl font-bold '+card.c+'">'+card.v+'</p></div>';
  });
  h+='</div>';
  /* P&L Breakdown */
  h+='<div class="grid md:grid-cols-2 gap-6">';
  h+='<div class="border-2 border-slate-300 rounded-xl p-5"><h3 class="font-bold text-sm mb-3 flex items-center gap-2"><span class="w-2 h-2 rounded-full bg-slate-400"></span>ì´ˆê¸° íˆ¬ìê¸ˆ êµ¬ì„±</h3><div class="space-y-2">';
  [{l:'ë³´ì¦ê¸ˆ',v:r.avg_rent_pyeong*r.area_pyeong*10,c:'bg-blue-400'},{l:'ì¸í…Œë¦¬ì–´',v:r.area_pyeong*200,c:'bg-amber-400'},{l:'ì˜ë£Œì¥ë¹„',v:12000,c:'bg-emerald-400'},{l:'ìš´ì˜ìê¸ˆ',v:3000,c:'bg-purple-400'}].forEach(function(item){
    var pct=Math.round(item.v/ti*100);
    h+='<div class="flex items-center gap-2"><span class="text-xs text-gray-500 w-16">'+item.l+'</span><div class="flex-1 h-2.5 bg-gray-100 rounded-full overflow-hidden"><div class="h-full '+item.c+' rounded-full" style="width:'+pct+'%"></div></div><span class="text-xs font-medium w-24 text-right">'+fmt(item.v)+'ë§Œ <span class="text-gray-400">('+pct+'%)</span></span></div>';
  });
  h+='<div class="pt-3 mt-1 border-t border-slate-200 flex justify-between text-sm font-bold"><span>í•©ê³„</span><span class="text-slate-700">'+(ti/10000).toFixed(1)+'ì–µì›</span></div></div></div>';
  h+='<div class="border-2 border-emerald-300 rounded-xl p-5"><h3 class="font-bold text-sm mb-3 flex items-center gap-2"><span class="w-2 h-2 rounded-full bg-emerald-400"></span>ì›”ê°„ ì†ìµ êµ¬ì¡°</h3>';
  h+='<div class="bg-green-50 rounded-lg p-3 mb-3"><div class="flex justify-between text-sm text-green-700 font-medium"><span>ì˜ˆìƒ ì›”ë§¤ì¶œ</span><span class="font-bold">'+fmt(mRev)+'ë§Œì›</span></div><p class="text-xs text-green-600 mt-1">ì¼ '+dp+'ëª… Ã— 15ë§Œì› Ã— 25ì¼</p></div>';
  h+='<div class="space-y-1.5">';
  [{l:'ì„ëŒ€ë£Œ',v:mr},{l:'ê´€ë¦¬ë¹„',v:Math.round(r.area_pyeong*5)},{l:'ì¸ê±´ë¹„',v:800},{l:'ì¬ë£Œë¹„(15%)',v:Math.round(mRev*0.15)},{l:'ê¸°íƒ€',v:300}].forEach(function(item){
    h+='<div class="flex justify-between text-sm"><span class="text-gray-500">(-) '+item.l+'</span><span class="text-red-500">'+fmt(item.v)+'ë§Œ</span></div>';
  });
  h+='<div class="pt-3 mt-1 border-t border-emerald-200 flex justify-between font-bold text-sm"><span>ì›” ìˆœì´ìµ</span><span class="'+(mP>0?'text-blue-600':'text-red-500')+'">'+(mP>0?'+':'')+fmt(mP)+'ë§Œì›</span></div>';
  h+='</div></div></div></section>';

  /* â”€â”€ 09 RISK & OPPORTUNITY â”€â”€ */
  h+='<section class="bg-white rounded-2xl border-2 border-amber-300 p-6 md:p-8 shadow-sm mb-6 fade-in fade-in-9">';
  h+='<div class="flex items-center gap-3 mb-6"><span class="text-xs font-bold text-white bg-blue-600 w-7 h-7 rounded-lg flex items-center justify-center">08</span><h2 class="text-lg font-bold">ë¦¬ìŠ¤í¬ & ê¸°íšŒ ë¶„ì„</h2></div>';
  h+='<div class="grid md:grid-cols-2 gap-6">';
  h+='<div><h3 class="font-semibold text-red-600 text-sm mb-3 flex items-center gap-1"><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L4.082 16.5c-.77.833.192 2.5 1.732 2.5z"/></svg>ë¦¬ìŠ¤í¬ ìš”ì¸</h3>';
  h+='<div class="space-y-2">';
  risks.forEach(function(rk){
    var sevColor=rk.sev==='high'?'bg-red-50 border-red-200 text-red-800':rk.sev==='medium'?'bg-yellow-50 border-yellow-200 text-yellow-800':'bg-gray-50 border-gray-200 text-gray-700';
    h+='<div class="'+sevColor+' border rounded-lg p-3"><p class="font-semibold text-sm">'+rk.t+'</p><p class="text-xs mt-0.5 opacity-80">'+rk.d+'</p></div>';
  });
  h+='</div></div>';
  h+='<div><h3 class="font-semibold text-green-600 text-sm mb-3 flex items-center gap-1"><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>ê¸°íšŒ ìš”ì¸</h3>';
  h+='<div class="space-y-2">';
  opps.forEach(function(op){
    h+='<div class="bg-green-50 border border-green-200 text-green-800 rounded-lg p-3"><p class="font-semibold text-sm">'+op.t+'</p><p class="text-xs mt-0.5 opacity-80">'+op.d+'</p></div>';
  });
  h+='</div></div></div>';
  /* Risk-Opportunity comprehensive advice (~200 words) */
  var highRiskCnt=risks.filter(function(rk){return rk.sev==='high'}).length;
  var riskBalance=highRiskCnt===0?'positive':highRiskCnt>=2?'negative':'neutral';
  var adviceOpen='';
  if(riskBalance==='positive'){
    adviceOpen+='ì¢…í•©ì ìœ¼ë¡œ '+r.dong+' ì§€ì—­ì€ <b>ê¸°íšŒ ìš”ì¸ì´ ë¦¬ìŠ¤í¬ ìš”ì¸ì„ ìƒíšŒ</b>í•˜ëŠ” ê¸ì •ì ì¸ ì…ì§€ì…ë‹ˆë‹¤. ';
    adviceOpen+='ê³ ìœ„í—˜ ìš”ì¸ì´ ë°œê²¬ë˜ì§€ ì•Šì•˜ìœ¼ë©°, '+opps.length+'ê°œì˜ ê¸°íšŒ ìš”ì¸ì´ ì•ˆì •ì ì¸ ê°œì› í™˜ê²½ì„ ë’·ë°›ì¹¨í•©ë‹ˆë‹¤. ';
    adviceOpen+='ì´ ì§€ì—­ì—ì„œ ê°œì›ì„ ê³ ë ¤ ì¤‘ì¸ ì›ì¥ë‹˜ê»˜ì„œëŠ” <b>ì ê·¹ì ì¸ ê°œì› ì¶”ì§„</b>ì„ ê¶Œì¥ë“œë¦½ë‹ˆë‹¤. ';
  }else if(riskBalance==='negative'){
    adviceOpen+='ì¢…í•©ì ìœ¼ë¡œ '+r.dong+' ì§€ì—­ì€ <b>ê³ ìœ„í—˜ ìš”ì¸ì´ '+highRiskCnt+'ê±´ ê°ì§€</b>ë˜ì–´ ì‹ ì¤‘í•œ ì ‘ê·¼ì´ í•„ìš”í•œ ì…ì§€ì…ë‹ˆë‹¤. ';
    adviceOpen+='ë¦¬ìŠ¤í¬ ìš”ì¸ì´ ê¸°íšŒ ìš”ì¸ë³´ë‹¤ ë¬´ê²Œê°ì´ í¬ë¯€ë¡œ, ê°œì› ì „ ë°˜ë“œì‹œ í•´ë‹¹ ë¦¬ìŠ¤í¬ì— ëŒ€í•œ êµ¬ì²´ì ì¸ ëŒ€ì‘ ì „ëµ ìˆ˜ë¦½ì´ ì„ í–‰ë˜ì–´ì•¼ í•©ë‹ˆë‹¤. ';
    adviceOpen+='ì´ ì§€ì—­ì—ì„œ ê°œì›ì„ ê³ ë ¤ ì¤‘ì¸ ì›ì¥ë‹˜ê»˜ì„œëŠ” <b>ì¶©ë¶„í•œ ì‚¬ì „ ê²€ì¦</b> í›„ ì˜ì‚¬ê²°ì •í•˜ì‹œê¸°ë¥¼ ê¶Œì¥í•©ë‹ˆë‹¤. ';
  }else{
    adviceOpen+='ì¢…í•©ì ìœ¼ë¡œ '+r.dong+' ì§€ì—­ì€ <b>ê¸°íšŒì™€ ë¦¬ìŠ¤í¬ê°€ í˜¼ì¬</b>í•˜ëŠ” ì…ì§€ì…ë‹ˆë‹¤. ';
    adviceOpen+='ì¼ë¶€ ì£¼ì˜ê°€ í•„ìš”í•œ ìš”ì¸ì´ ì¡´ì¬í•˜ë‚˜, ì ì ˆí•œ ì „ëµ ìˆ˜ë¦½ì„ í†µí•´ ì¶©ë¶„íˆ ê·¹ë³µ ê°€ëŠ¥í•œ ìˆ˜ì¤€ì…ë‹ˆë‹¤. ';
    adviceOpen+='ì´ ì§€ì—­ì—ì„œ ê°œì›ì„ ê³ ë ¤ ì¤‘ì¸ ì›ì¥ë‹˜ê»˜ì„œëŠ” <b>ë¦¬ìŠ¤í¬ ìš”ì¸ì— ëŒ€í•œ êµ¬ì²´ì  ëŒ€ì‘ ë°©ì•ˆì„ ë§ˆë ¨í•œ í›„ ê°œì›ì„ ì¶”ì§„</b>í•˜ì‹œê¸¸ ê¶Œì¥í•©ë‹ˆë‹¤. ';
  }
  adviceOpen+='íŠ¹íˆ ë°˜ê²½ 500m ë‚´ '+r.dental_count+'ê°œ ì¹˜ê³¼ê°€ ìš´ì˜ ì¤‘ì¸ ê²½ìŸ í™˜ê²½ì—ì„œ ì°¨ë³„í™” ì „ëµì€ í•„ìˆ˜ì ì…ë‹ˆë‹¤. ';
  adviceOpen+=r.age_20_39_pct>=35?'20~39ì„¸ ì¸êµ¬ ë¹„ìœ¨ì´ '+r.age_20_39_pct+'%ë¡œ ë†’ì•„ ì‹¬ë¯¸Â·êµì • ë“± ê³ ë‹¨ê°€ ë¹„ê¸‰ì—¬ ì§„ë£Œì— íŠ¹í™”í•˜ë©´ ê²½ìŸ ìš°ìœ„ë¥¼ í™•ë³´í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ':'ì„í”Œë€íŠ¸Â·ë³´ì²  ì¤‘ì‹¬ì˜ ì§„ë£Œ í¬íŠ¸í´ë¦¬ì˜¤ë¥¼ êµ¬ì¶•í•˜ì—¬ ì§€ì—­ ë‚´ ì¤‘ì¥ë…„ì¸µ ìˆ˜ìš”ë¥¼ ì„ ì í•˜ëŠ” ì „ëµì´ ìœ íš¨í•©ë‹ˆë‹¤. ';
  adviceOpen+='ì›” ì˜ˆìƒ ìˆœì´ìµ '+(mP>0?'+':'')+fmt(mP)+'ë§Œì›, ì†ìµë¶„ê¸° ì•½ '+be+'ê°œì›” ê¸°ì¤€ìœ¼ë¡œ ';
  adviceOpen+=mP>0&&be<=24?'<b>ì¬ë¬´ì  íƒ€ë‹¹ì„±ì€ ì–‘í˜¸</b>í•©ë‹ˆë‹¤. ':mP>0?'ì¬ë¬´ì ìœ¼ë¡œ ì•ˆì •í™”ê¹Œì§€ ë‹¤ì†Œ ì‹œê°„ì´ ì†Œìš”ë  ìˆ˜ ìˆì–´ <b>ì¶©ë¶„í•œ ìš´ì˜ìê¸ˆ í™•ë³´</b>ê°€ ì¤‘ìš”í•©ë‹ˆë‹¤. ':'<b>ìˆ˜ìµ êµ¬ì¡° ê°œì„  ë°©ì•ˆì„ ë°˜ë“œì‹œ ì‚¬ì „ì— ìˆ˜ë¦½</b>í•´ì•¼ í•©ë‹ˆë‹¤. ';
  adviceOpen+='ê°œì› í›„ ì´ˆê¸° 6ê°œì›”ì€ í™˜ì í™•ë³´ë¥¼ ìœ„í•œ ë§ˆì¼€íŒ… íˆ¬ìê°€ ì§‘ì¤‘ì ìœ¼ë¡œ í•„ìš”í•˜ë©°, ë„¤ì´ë²„ í”Œë ˆì´ìŠ¤ ìµœì í™”Â·ë¸”ë¡œê·¸ ì½˜í…ì¸ Â·ì§€ì—­ ì»¤ë®¤ë‹ˆí‹° í™œë™ì„ ë³‘í–‰í•˜ì‹œê¸° ë°”ëë‹ˆë‹¤. ';
  adviceOpen+='ìµœì¢… ì˜ì‚¬ê²°ì • ì „ ë°˜ë“œì‹œ <b>í˜„ì¥ ë‹µì‚¬, ë¶€ë™ì‚° ì „ë¬¸ê°€ ìƒë‹´, ì„¸ë¬´Â·ë²•ë¥  ìë¬¸</b>ì„ ê±°ì³ ë³¸ ë¦¬í¬íŠ¸ì˜ ë¶„ì„ ê²°ê³¼ë¥¼ êµì°¨ ê²€ì¦í•˜ì‹œê¸¸ ê°•ë ¥íˆ ê¶Œê³ ë“œë¦½ë‹ˆë‹¤.';
  h+='<div class="mt-6 bg-slate-50 border border-slate-200 rounded-xl p-5"><div class="flex items-center gap-2 mb-3"><span class="text-base">ğŸ’¡</span><h3 class="font-bold text-sm text-slate-800">ì¢…í•© í‰ê°€ ë° ê°œì› ì¡°ì–¸</h3></div><p class="text-sm text-slate-700 leading-relaxed">'+adviceOpen+'</p></div>';
  h+='</section>';

  /* â”€â”€ 10 RECOMMENDATIONS â”€â”€ */
  h+='<section class="bg-white rounded-2xl border-2 border-sky-300 p-6 md:p-8 shadow-sm mb-6 fade-in fade-in-10">';
  h+='<div class="flex items-center gap-3 mb-6"><span class="text-xs font-bold text-white bg-blue-600 w-7 h-7 rounded-lg flex items-center justify-center">09</span><h2 class="text-lg font-bold">ê¶Œì¥ ì‚¬í•­ ë° ë‹¤ìŒ ë‹¨ê³„</h2></div>';
  h+='<div class="grid md:grid-cols-3 gap-4">';
  var recs=[];
  if(ts>=70){
    var rec1d='ë³¸ AI ë¶„ì„ ê²°ê³¼ '+r.dong+' ì§€ì—­ì€ ì¢…í•© '+ts+'ì ìœ¼ë¡œ <b>'+sl+'</b> íŒì •ì„ ë°›ì•˜ìŠµë‹ˆë‹¤. ';
    rec1d+='ì¸êµ¬ '+fmt(r.population)+'ëª…, ìœ ë™ì¸êµ¬ ì¼ '+fmt(r.daily_floating)+'ëª…ì˜ ìˆ˜ìš” ê¸°ë°˜ê³¼ ';
    rec1d+=r.scores.competition>=60?'ìƒëŒ€ì ìœ¼ë¡œ ì–‘í˜¸í•œ ê²½ìŸ í™˜ê²½':'ë‹¤ì†Œ ì¹˜ì—´í•˜ì§€ë§Œ ì°¨ë³„í™” ê°€ëŠ¥í•œ ê²½ìŸ í™˜ê²½';
    rec1d+='ì„ ê³ ë ¤í•  ë•Œ, ì¶”ì²œ ìœ„ì¹˜ AÂ·Bë¥¼ ì¤‘ì‹¬ìœ¼ë¡œ êµ¬ì²´ì ì¸ ì„ëŒ€ ë¬¼ê±´ íƒìƒ‰ì— ì°©ìˆ˜í•˜ì‹œê¸¸ ê¶Œì¥í•©ë‹ˆë‹¤. ';
    rec1d+='ê°œì› ì‹œê¸°ëŠ” ì„ëŒ€ ê³„ì•½ë¶€í„° ì¸í…Œë¦¬ì–´ ì™„ê³µê¹Œì§€ í†µìƒ 3~4ê°œì›”ì´ ì†Œìš”ë˜ë¯€ë¡œ, ëª©í‘œ ê°œì›ì¼ ê¸°ì¤€ ìµœì†Œ 6ê°œì›” ì „ë¶€í„° ì¤€ë¹„ë¥¼ ì‹œì‘í•˜ëŠ” ê²ƒì´ ë°”ëŒì§í•©ë‹ˆë‹¤.';
    recs.push({n:'1',t:'ê°œì› ì¶”ì§„',d:rec1d,c:'bg-blue-50 border-blue-200'});
  }else{
    var rec1d='ë³¸ AI ë¶„ì„ ê²°ê³¼ '+r.dong+' ì§€ì—­ì€ ì¢…í•© '+ts+'ì ìœ¼ë¡œ <b>'+sl+'</b> íŒì •ì„ ë°›ì•˜ìŠµë‹ˆë‹¤. ';
    rec1d+=highRiskCnt>0?'ê³ ìœ„í—˜ ìš”ì¸ '+highRiskCnt+'ê±´ì´ ê°ì§€ë˜ì—ˆìœ¼ë¯€ë¡œ, ':'ì¼ë¶€ ë¦¬ìŠ¤í¬ ìš”ì¸ì´ í™•ì¸ë˜ì—ˆìœ¼ë¯€ë¡œ, ';
    rec1d+='ì¦‰ê°ì ì¸ ê°œì›ë³´ë‹¤ëŠ” ì¶”ê°€ì ì¸ í˜„ì¥ ì¡°ì‚¬ì™€ ì‹œì¥ ë¶„ì„ì´ ì„ í–‰ë˜ì–´ì•¼ í•©ë‹ˆë‹¤. ';
    rec1d+='íŠ¹íˆ ë°˜ê²½ 500m ë‚´ ì¹˜ê³¼ '+r.dental_count+'ê°œì˜ ê²½ìŸ êµ¬ë„ì™€ í‰ë‹¹ '+r.avg_rent_pyeong+'ë§Œì›ì˜ ì„ëŒ€ë£Œ ìˆ˜ì¤€ì„ ë©´ë°€íˆ ì¬ê²€í† í•˜ì‹œê¸° ë°”ëë‹ˆë‹¤. ';
    rec1d+='ì¸ê·¼ ìœ ì‚¬ ìƒê¶Œì˜ ë¹„êµ ë¶„ì„ì„ í†µí•´ ë³´ë‹¤ ìœ ë¦¬í•œ ëŒ€ì•ˆ ì…ì§€ë¥¼ í•¨ê»˜ íƒìƒ‰í•˜ì‹œëŠ” ê²ƒì„ ê¶Œì¥ë“œë¦½ë‹ˆë‹¤.';
    recs.push({n:'1',t:'ì¶”ê°€ ì¡°ì‚¬',d:rec1d,c:'bg-yellow-50 border-yellow-200'});
  }
  var rec2d='ì¶”ì²œ ìœ„ì¹˜ Aì™€ Bë¥¼ ë°˜ë“œì‹œ ì§ì ‘ ë°©ë¬¸í•˜ì—¬ í˜„ì¥ ì—¬ê±´ì„ í™•ì¸í•˜ì„¸ìš”. ';
  rec2d+='ì£¼ìš” í™•ì¸ ì‚¬í•­ìœ¼ë¡œëŠ” â‘  ê±´ë¬¼ ìƒíƒœ ë° ì¸µìˆ˜ë³„ ì„ëŒ€ ì¡°ê±´ ë¹„êµ, â‘¡ '+r.subway_station+' ë°©ë©´ ë„ë³´ ì ‘ê·¼ì„±ê³¼ ëŒ€ì¤‘êµí†µ í¸ì˜ì„±, â‘¢ ì£¼ì°¨ì¥ í™•ë³´ ê°€ëŠ¥ ì—¬ë¶€ì™€ ì¸ê·¼ ìœ ë£Œ ì£¼ì°¨ì¥ í˜„í™©, â‘£ ì£¼ë³€ ì•½êµ­Â·ë³‘ì› ë“± ì˜ë£Œ í´ëŸ¬ìŠ¤í„° í˜•ì„± ì—¬ë¶€ì…ë‹ˆë‹¤. ';
  rec2d+='ë°©ë¬¸ ì‹œ í‰ì¼ ì˜¤ì „Â·ì˜¤í›„, ì£¼ë§ ë“± ì‹œê°„ëŒ€ë³„ ìœ ë™ì¸êµ¬ ë³€í™”ë¥¼ ì§ì ‘ ê´€ì°°í•˜ê³ , ì¸ê·¼ ì¹˜ê³¼ì— í™˜ìë¡œì„œ ë°©ë¬¸í•˜ì—¬ ì„œë¹„ìŠ¤ ìˆ˜ì¤€ê³¼ ê°€ê²©ëŒ€ë¥¼ íŒŒì•…í•˜ë©´ ê²½ìŸ ì „ëµ ìˆ˜ë¦½ì— í° ë„ì›€ì´ ë©ë‹ˆë‹¤.';
  recs.push({n:'2',t:'í˜„ì¥ ì‹¤ì‚¬',d:rec2d,c:'bg-green-50 border-green-200'});
  var rec3d='ë³¸ ë¦¬í¬íŠ¸ì˜ íˆ¬ì ì‹œë®¬ë ˆì´ì…˜ ê²°ê³¼(ì´ íˆ¬ìê¸ˆ '+(ti/10000).toFixed(1)+'ì–µ, ì›” ìˆœì´ìµ '+(mP>0?'+':'')+fmt(mP)+'ë§Œì›, ì†ìµë¶„ê¸° '+be+'ê°œì›”)ë¥¼ ì„¸ë¬´ì‚¬Â·íšŒê³„ì‚¬ì™€ ê³µìœ í•˜ì—¬ ìê¸ˆ ì¡°ë‹¬ ê³„íšì„ êµ¬ì²´í™”í•˜ì„¸ìš”. ';
  rec3d+='ì¹˜ê³¼ê²½ì˜ ì»¨ì„¤í„´íŠ¸ë¥¼ í†µí•´ ì§„ë£Œ í¬íŠ¸í´ë¦¬ì˜¤ êµ¬ì„±, ì¸ë ¥ ì±„ìš© ê³„íš, ì¥ë¹„ ì„ ì •ì„ ë³‘í–‰í•˜ì‹œê¸° ë°”ëë‹ˆë‹¤. ';
  rec3d+='ë˜í•œ ê°œì› ì „ ë²•ë¥  ìë¬¸ì„ í†µí•´ ì„ëŒ€ì°¨ ê³„ì•½ ì¡°ê±´, ì˜ë£Œë²• ê´€ë ¨ ì¸í—ˆê°€ ì ˆì°¨, ê´‘ê³  ê·œì œ ë“±ì„ ì‚¬ì „ì— ê²€í† í•˜ì—¬ ê°œì› í›„ ë°œìƒí•  ìˆ˜ ìˆëŠ” ë²•ì  ë¦¬ìŠ¤í¬ë¥¼ ìµœì†Œí™”í•˜ì‹œê¸¸ ê¶Œê³ ë“œë¦½ë‹ˆë‹¤.';
  recs.push({n:'3',t:'ì „ë¬¸ê°€ ìƒë‹´',d:rec3d,c:'bg-purple-50 border-purple-200'});
  recs.forEach(function(rc){
    h+='<div class="'+rc.c+' border rounded-xl p-5"><div class="flex items-center gap-2 mb-2"><span class="text-xs font-bold text-white bg-gray-800 w-6 h-6 rounded-full flex items-center justify-center">'+rc.n+'</span><h3 class="font-bold text-sm">'+rc.t+'</h3></div><p class="text-sm text-gray-600">'+rc.d+'</p></div>';
  });
  h+='</div></section>';

  /* â”€â”€ CONTACT â”€â”€ */
  h+='<div class="bg-blue-50 border border-blue-200 rounded-xl p-6 mb-6 text-center">';
  h+='<p class="text-sm font-bold text-blue-900 mb-2">ë´íƒˆë§µAI ì¹˜ê³¼ê°œì› ì…ì§€ë¶„ì„ ë¦¬í¬íŠ¸ ë¬¸ì˜ ë° ìš”ì²­ì€ ì•„ë˜ ì—°ë½ì²˜ë¡œ ì•Œë ¤ì£¼ì„¸ìš”</p>';
  h+='<div class="flex flex-col sm:flex-row items-center justify-center gap-4 mt-3">';
  h+='<div class="flex items-center gap-2 text-sm text-blue-800"><svg class="w-4 h-4 text-blue-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/></svg><span class="font-semibold">ì‹¬ì¬ìš° ëŒ€í‘œ</span></div>';
  h+='<div class="flex items-center gap-2 text-sm text-blue-800"><svg class="w-4 h-4 text-blue-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"/></svg><a href="mailto:jaiwshim@gmail.com" class="hover:underline">jaiwshim@gmail.com</a></div>';
  h+='<div class="flex items-center gap-2 text-sm text-blue-800"><svg class="w-4 h-4 text-blue-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"/></svg><a href="tel:010-2397-5734" class="hover:underline">010-2397-5734</a></div>';
  h+='</div></div>';

  /* â”€â”€ DISCLAIMER â”€â”€ */
  h+='<div class="bg-gray-100 rounded-xl p-4 text-xs text-gray-600 mb-6">ë³¸ AI ì…ì§€ë¶„ì„ ë¦¬í¬íŠ¸ëŠ” ê³µê³µ ë°ì´í„° ê¸°ë°˜ì˜ ì°¸ê³  ìë£Œì´ë©°, ë²•ì  íš¨ë ¥ì´ ì—†ìŠµë‹ˆë‹¤.<br>íˆ¬ì ê²°ì • ì‹œ ë°˜ë“œì‹œ ì „ë¬¸ê°€ì™€ ìƒë‹´í•˜ì‹œê¸° ë°”ëë‹ˆë‹¤. | &copy; '+new Date().getFullYear()+' DentalMap AI Â· Report ID: '+reportId+'</div>';

  /* â”€â”€ ACTION BUTTONS â”€â”€ */
  h+='<div class="flex flex-wrap gap-3 justify-center py-6 no-print">';
  h+='<button onclick="window.print()" class="bg-blue-600 text-white font-semibold px-6 py-3 rounded-xl hover:bg-blue-700 transition flex items-center gap-2 shadow-lg shadow-blue-600/20"><svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z"/></svg>PDF / ì¸ì‡„</button>';
  h+='<a href="analysis.html?q='+encodeURIComponent(r.dong)+'" class="border border-gray-300 text-gray-700 font-semibold px-6 py-3 rounded-xl hover:bg-gray-50 transition flex items-center gap-2"><svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 17l-5-5m0 0l5-5m-5 5h12"/></svg>ìƒì„¸ ë¶„ì„ìœ¼ë¡œ ëŒì•„ê°€ê¸°</a>';
  h+='<a href="analysis.html" class="border border-gray-300 text-gray-700 font-semibold px-6 py-3 rounded-xl hover:bg-gray-50 transition">ë‹¤ë¥¸ ì§€ì—­ ë¶„ì„</a>';
  h+='</div>';

  h+='</div>';

  document.getElementById('report-root').innerHTML=h;

  /* Render map after DOM update */
  setTimeout(function(){renderReportMap(r,clinics,spots)},200);
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   LOADING SCREEN (3 phases)
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function showLoading(name){
  var phases=['ë°ì´í„° ìˆ˜ì§‘ ì¤‘...','AI ë¶„ì„ ì§„í–‰ ì¤‘...','ë¦¬í¬íŠ¸ ìƒì„± ì¤‘...'];
  var h='<div class="min-h-[80vh] flex items-center justify-center"><div class="text-center max-w-sm mx-auto">';
  h+='<div class="relative w-24 h-24 mx-auto mb-8"><svg class="animate-spin w-24 h-24 text-blue-600" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"/><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"/></svg><div class="absolute inset-0 flex items-center justify-center"><span class="text-2xl">ğŸ“‹</span></div></div>';
  h+='<h2 class="text-xl font-bold text-gray-800">AI ì…ì§€ë¶„ì„ ë¦¬í¬íŠ¸ ìƒì„±</h2>';
  h+='<p class="mt-2 text-gray-500"><span class="text-blue-600 font-semibold">'+name+'</span></p>';
  h+='<div class="mt-8 space-y-3" id="loading-phases">';
  phases.forEach(function(p,i){
    h+='<div class="flex items-center gap-3 text-sm text-gray-400" id="phase-'+i+'"><div class="w-5 h-5 rounded-full border-2 border-gray-200 flex items-center justify-center shrink-0" id="phase-icon-'+i+'"></div><span>'+p+'</span></div>';
  });
  h+='</div>';
  h+='<div class="mt-6 w-full h-1.5 bg-gray-100 rounded-full overflow-hidden"><div id="load-bar" class="h-full bg-blue-600 rounded-full transition-all duration-500" style="width:0%"></div></div>';
  h+='</div></div>';
  document.getElementById('report-root').innerHTML=h;

  /* Animate phases */
  var bar=document.getElementById('load-bar');
  setTimeout(function(){
    document.getElementById('phase-0').classList.replace('text-gray-400','text-blue-600');
    document.getElementById('phase-icon-0').innerHTML='<svg class="animate-spin w-4 h-4 text-blue-600" fill="none" viewBox="0 0 24 24"><path fill="currentColor" d="M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"/></svg>';
    bar.style.width='20%';
  },100);
  setTimeout(function(){
    document.getElementById('phase-icon-0').innerHTML='<svg class="w-4 h-4 text-green-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/></svg>';
    document.getElementById('phase-0').classList.replace('text-blue-600','text-green-600');
    document.getElementById('phase-1').classList.replace('text-gray-400','text-blue-600');
    document.getElementById('phase-icon-1').innerHTML='<svg class="animate-spin w-4 h-4 text-blue-600" fill="none" viewBox="0 0 24 24"><path fill="currentColor" d="M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"/></svg>';
    bar.style.width='50%';
  },1000);
  setTimeout(function(){
    document.getElementById('phase-icon-1').innerHTML='<svg class="w-4 h-4 text-green-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/></svg>';
    document.getElementById('phase-1').classList.replace('text-blue-600','text-green-600');
    document.getElementById('phase-2').classList.replace('text-gray-400','text-blue-600');
    document.getElementById('phase-icon-2').innerHTML='<svg class="animate-spin w-4 h-4 text-blue-600" fill="none" viewBox="0 0 24 24"><path fill="currentColor" d="M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"/></svg>';
    bar.style.width='80%';
  },2000);
}

function showNoRegion(){
  document.getElementById('report-root').innerHTML='<div class="min-h-[80vh] flex items-center justify-center"><div class="max-w-md mx-auto text-center px-6"><div class="text-6xl mb-6">ğŸ“‹</div><h1 class="text-2xl font-bold">AI ì…ì§€ë¶„ì„ ë¦¬í¬íŠ¸</h1><p class="mt-3 text-gray-500">ë¦¬í¬íŠ¸ë¥¼ ìƒì„±í•  ì§€ì—­ì„ ì„ íƒí•´ì£¼ì„¸ìš”.</p><a href="analysis.html" class="mt-6 inline-block bg-blue-600 text-white font-semibold px-8 py-3 rounded-xl hover:bg-blue-700 transition">ì…ì§€ë¶„ì„ í˜ì´ì§€ì—ì„œ ì§€ì—­ ì„ íƒ</a></div></div>';
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   INIT
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
document.addEventListener('DOMContentLoaded',function(){
  var params=new URLSearchParams(window.location.search);
  var q=params.get('q');
  if(!q||!q.trim()){showNoRegion();return}
  var name=q.trim();
  var direct=params.get('direct');

  function loadReport(){
    var r=REGIONS.find(function(x){return x.dong===name||x.dong.includes(name)});
    if(!r)r=REGIONS.find(function(x){return x.sigungu.includes(name)||x.sido.includes(name)});
    if(!r)r=addGeneratedRegion(name);
    document.title=r.dong+' AI ì…ì§€ë¶„ì„ ë¦¬í¬íŠ¸ â€” ë´íƒˆë§µ';
    renderReport(r);
  }

  if(direct==='1'){
    loadReport();
  } else {
    showLoading(name);
    setTimeout(loadReport,3000);
  }
});
</script>
</body>
</html>
